<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="UTF-8">
<meta name="description" content="Motif Alignment and Search Tool (MAST) output.">
<title>MAST</title>
<style type="text/css">
    
    /* START INCLUDED FILE "meme.css" */
        /* The following is the content of meme.css */
        body { background-color:white; font-size: 12px; font-family: Verdana, Arial, Helvetica, sans-serif;}

        div.help {
          display: inline-block;
          margin: 0px;
          padding: 0px;
          width: 12px;
          height: 13px;
          cursor: pointer;
          background-image: url(data:image/gif;base64,R0lGODlhDAANAIABANR0AP///yH5BAEAAAEALAAAAAAMAA0AAAIdhI8Xy22MIFgv1DttrrJ7mlGNNo4c+aFg6SQuUAAAOw==);
        }

        div.help:hover {
          background-image: url(data:image/gif;base64,R0lGODlhDAANAKEAANR0AP///9R0ANR0ACH+EUNyZWF0ZWQgd2l0aCBHSU1QACH5BAEAAAIALAAAAAAMAA0AAAIdDGynCe3PgoxONntvwqz2/z2K2ImjR0KhmSIZUgAAOw==);
        }
        
        p.spaced { line-height: 1.8em;}
        
        span.citation { font-family: "Book Antiqua", "Palatino Linotype", serif; color: #004a4d;}

        p.pad { padding-left: 30px; padding-top: 5px; padding-bottom: 10px;}

        td.jump { font-size: 13px; color: #ffffff; background-color: #00666a;
          font-family: Georgia, "Times New Roman", Times, serif;}

        a.jump { margin: 15px 0 0; font-style: normal; font-variant: small-caps;
          font-weight: bolder; font-family: Georgia, "Times New Roman", Times, serif;}

        h2.mainh {font-size: 1.5em; font-style: normal; margin: 15px 0 0;
          font-variant: small-caps; font-family: Georgia, "Times New Roman", Times, serif;}

        h2.line {border-bottom: 1px solid #CCCCCC; font-size: 1.5em; font-style: normal;
          margin: 15px 0 0; padding-bottom: 3px; font-variant: small-caps;
          font-family: Georgia, "Times New Roman", Times, serif;}

        h4 {border-bottom: 1px solid #CCCCCC; font-size: 1.2em; font-style: normal;
          margin: 10px 0 0; padding-bottom: 3px; font-family: Georgia, "Times New Roman", Times, serif;}

        h5 {margin: 0px}

        a.help { font-size: 9px; font-style: normal; text-transform: uppercase;
          font-family: Georgia, "Times New Roman", Times, serif;}

        div.pad { padding-left: 30px; padding-top: 5px; padding-bottom: 10px;}
        
        div.pad1 { margin: 10px 5px;}

        div.pad2 { margin: 25px 5px 5px;}
        h2.pad2 { padding: 25px 5px 5px;}

        div.pad3 { padding: 5px 0px 10px 30px;}

        div.box { border: 2px solid #CCCCCC; padding:10px; overflow: hidden;}

        div.bar { border-left: 7px solid #00666a; padding:5px; margin-top:25px; }

        div.subsection {margin:25px 0px;}

        img {border:0px none;}

        th.majorth {text-align:left;}
        th.minorth {font-weight:normal; text-align:left; width:8em; padding: 3px 0px;}
        th.actionth {font-weight:normal; text-align:left;}

        .block_td {height:25px;}
        .block_container {position:relative; width:98%; height:25px; padding:0px; margin: 0px 0px 0px 1em;}
        .block_motif {position:absolute; z-index:3; height:12px; top:0px; text-align:center; vertical-align:middle; background-color:cyan;}
        .block_rule {position:absolute; z-index:2; width:100%; height:1px; top:12px; left:0px; background-color:gray;}
        .block_plus_sym {position:absolute; z-index:4; line-height:12px; top:0px; left:-1em;}
        .block_minus_sym {position:absolute; z-index:4; line-height:12px; top:13px; left:-1em;}

        .tic_major {position:absolute; border-left:2px solid blue; height:0.5em; top:0em;}
        .tic_minor {position:absolute; border-left:1px solid blue; height:0.2em; top:0em;}
        .tic_label {position:absolute; top:0.5em;  height: 1em; text-align:center; vertical-align:middle}

        .explain h5 {font-size:1em; margin-left: 1em;}

        div.doc {margin-left: 2em; margin-bottom: 3em;}
        
        th.trainingset {
          border-bottom: thin dashed black; 
          font-weight:normal; 
          padding:0px 10px;
        }
        .dnaseq {
          font-weight: bold; 
          font-size: large; 
          font-family: 'Courier New', Courier, monospace;
        }
        .dna_A {
          color: rgb(204,0,0);
        }
        .dna_C {
          color: rgb(0,0,204);
        }
        .dna_G {
          color: rgb(255,179,0);
        }
        .dna_T {
          color: rgb(0,128,0);
        }
        div.pop_content {
          position:absolute;
          z-index:50;
          width:300px;
          padding: 5px;
          background: #E4ECEC;
          font-size: 12px;
          font-family: Arial;
          border-style: double;
          border-width: 3px;
          border-color: #AA2244;
          display:none;
        }
        div.pop_content > div.pop_close {
          float:right;
          bottom:0px;
        }
/*****************************************************************************
 * Program logo styling
 ****************************************************************************/
div.prog_logo {
  border-bottom: 0.25em solid #0f5f60;
  height: 4.5em;
  width: 24em;
  display:inline-block;
}
div.prog_logo img {
  float:left;
  width: 4em;
  border-style: none;
  margin-right: 0.2em;
}
div.prog_logo h1, div.prog_logo h1:hover, div.prog_logo h1:active, div.prog_logo h1:visited {
  margin:0;
  padding:0;
  font-family: Arial, Helvetica,  sans-serif;
  font-size: 3.2em;
  line-height: 1em;
  vertical-align: top;
  display: block;
  color: #026666;
  letter-spacing: -0.06em;
  text-shadow: 0.04em 0.06em 0.05em #666;
}
div.prog_logo h2, div.prog_logo h2:hover, div.prog_logo h2:active, div.prog_logo h2:visited {
  display: block;
  margin:0;
  padding:0;
  font-family: Helvetica, sans-serif;
  font-size: 0.9em;
  line-height: 1em;
  letter-spacing: -0.06em;
  color: black;
}

div.big.prog_logo {
  font-size: 18px;
}

    /* END INCLUDED FILE "meme.css" */
    
  
    
    /* START INCLUDED FILE "mast-to-html.css" */
.more_arrow {
  font-family:Arial,Serif;
  font-size: larger;
  font-weight: bold;
  text-decoration:none; 
}
div.infobox {
  background-color:#ddddff;
  margin-top: 1.6em;
  margin-bottom: 1em;
}
.sequence {
  font-family:Monospace;
}
.sequence_labels {
  position: relative; 
  width: 100%; 
  height: 2.5em; 
  padding: 0px; 
  margin: 0px;
}
.sequence_label {
  font-family:Serif; 
  position:absolute; 
  z-index:2; 
  height:1em; 
  text-align:center; 
  vertical-align:middle;
}
.sequence_label_top {
  top:0px;
}
.sequence_label_bottom {
  top:1.25em;
}
.inlineTitle {
  display:inline;
}
.block_needle {
  position:absolute;
  z-index:4;
  height:30px; 
  width:1px; 
  top:-2px; 
  background-color:gray;
}
.block_handle {
  position:absolute; 
  z-index:5; 
  height:1.1em; 
  width:3em; 
  top:30px; 
  left:-1.5em; 
  text-align:center; 
  vertical-align:middle;
  background-color: LightGrey; 
  border:3px outset grey;
}
.label_container {
  position:relative;
  width:100%;
  height:25px;
  padding:0px; 
  margin: 0px;
}
table.padded-table td { 
  padding:0px 10px; 
}
table.padded-table th { 
  padding:0px 5px; 
}
td.tnum {
  text-align:right;
}
tr.highlight {
  background:#aaffaa;
}
td.dim {
  color: gray;
}
span.dim {
  color: gray;
}

    /* END INCLUDED FILE "mast-to-html.css" */
    
  </style>
<script type="text/javascript">
    
    /* START INCLUDED FILE "utilities.js" */

/*
 * $
 *
 * Shorthand function for getElementById
 */
function $(el) {
  return document.getElementById(el);
}

/*
 * coords
 *
 * Calculates the x and y offset of an element.
 * From http://www.quirksmode.org/js/findpos.html
 * with alterations to take into account scrolling regions
 */
function coords(elem) {
  var myX = myY = 0;
  if (elem.getBoundingClientRect) {
    var rect;
    rect = elem.getBoundingClientRect();
    myX = rect.left + ((typeof window.pageXOffset !== "undefined") ?
        window.pageXOffset : document.body.scrollLeft);
    myY = rect.top + ((typeof window.pageYOffset !== "undefined") ?
        window.pageYOffset : document.body.scrollTop);
  } else {
    // this fall back doesn't properly handle absolutely positioned elements
    // inside a scrollable box
    var node;
    if (elem.offsetParent) {
      // subtract all scrolling
      node = elem;
      do {
        myX -= node.scrollLeft ? node.scrollLeft : 0;
        myY -= node.scrollTop ? node.scrollTop : 0;
      } while (node = node.parentNode);
      // this will include the page scrolling (which is unwanted) so add it back on
      myX += (typeof window.pageXOffset !== "undefined") ? window.pageXOffset : document.body.scrollLeft;
      myY += (typeof window.pageYOffset !== "undefined") ? window.pageYOffset : document.body.scrollTop;
      // sum up offsets
      node = elem;
      do {
        myX += node.offsetLeft;
        myY += node.offsetTop;
      } while (node = node.offsetParent);
    }
  }
  return [myX, myY];
}

/*
 * position_popup
 *
 * Positions a popup relative to an anchor element.
 *
 * The avaliable positions are:
 * 0 - Centered below the anchor.
 */
function position_popup(anchor, popup, position) {
  "use strict";
  var a_x, a_y, a_w, a_h, p_x, p_y, p_w, p_h;
  var a_xy, spacer, margin, scrollbar, page_w;
  // define constants
  spacer = 5;
  margin = 15;
  scrollbar = 15;
  // define the positions and widths
  a_xy = coords(anchor);
  a_x = a_xy[0];
  a_y = a_xy[1];
  a_w = anchor.offsetWidth;
  a_h = anchor.offsetHeight;
  p_w = popup.offsetWidth;
  p_h = popup.offsetHeight;
  page_w = null;
  if (window.innerWidth) {
    page_w = window.innerWidth;
  } else if (document.body) {
    page_w = document.body.clientWidth;
  }
  // check the position type is defined
  if (typeof position !== "undefined") {
    position = 0;
  }
  // calculate the popup position
  switch (position) {
    case 0:
    default:
      p_x = a_x + (a_w / 2) - (p_w / 2);
      p_y = a_y + a_h + spacer;
      break;
  }
  // constrain the popup position
  if (p_x < margin) {
    p_x = margin;
  } else if (page_w != null && (p_x + p_w) > (page_w - margin - scrollbar)) {
    p_x = page_w - margin - scrollbar - p_w;
  }
  if (p_y < margin) {
    p_y = margin;
  }
  // position the popup
  popup.style.left = p_x + "px";
  popup.style.top = p_y + "px";
}

/*
 * help_popup
 *
 * Moves around help pop-ups so they appear
 * below an activator.
 */
function help_popup(activator, popup_id) {
  "use strict";
  var _body, pop, info;
  // set default values
  if (typeof help_popup.popup === "undefined") {
    help_popup.popup = null;
  }
  if (typeof help_popup.activator === "undefined") {
    help_popup.activator = null;
  }
  if (typeof(activator) == "undefined") { // no activator so hide
    if (help_popup.popup) {
      help_popup.popup.style.display = 'none';
      help_popup.popup = null;
    }
    return;
  }
  pop = $(popup_id);
  if (pop == null) {
    _body = document.getElementsByTagName("body")[0];
    pop = document.createElement("div");
    pop.className = "pop_content";
    pop.id = popup_id;
    pop.style.backgroundColor = "#FFC";
    pop.style.borderColor = "black";
    info = document.createElement("p");
    info.style.fontWeight = "bold";
    info.appendChild(document.createTextNode("Error: No popup for topic \"" + popup_id + "\"."));
    pop.appendChild(info);
    // this might cause problems with the menu, but as this only happens
    // when something is already wrong I don't think that's too much of a problem
    _body.insertBefore(pop, _body.firstChild);
  }
  if (pop == help_popup.popup) {
    if (activator == help_popup.activator) {
      //hide popup (as we've already shown it for the current help button)
      help_popup.popup.style.display = 'none';
      help_popup.popup = null;
      return; // toggling complete!
    }
  } else if (help_popup.popup != null) {
    //activating different popup so hide current one
    help_popup.popup.style.display = 'none';
  }
  help_popup.popup = pop;
  help_popup.activator = activator;

  //must make the popup visible to measure it or it has zero width
  pop.style.display = 'block';
  position_popup(activator, pop);
}

/*
 * update_scroll_pad
 *
 * Creates padding at the bottom of the page to allow
 * scrolling of anything into view.
 */
function update_scroll_pad() {
  var page, pad;
  page = (document.compatMode === "CSS1Compat") ? document.documentElement : document.body;
  pad = $("scrollpad");
  if (pad === null) {
    pad = document.createElement("div");
    pad.id = 'scrollpad';
    document.getElementsByTagName('body')[0].appendChild(pad);
  }
  pad.style.height = Math.abs(page.clientHeight - 100) + "px";
}

function substitute_classes(node, remove, add) {
  "use strict";
  var list, all, i, cls, classes;
  list = node.className.split(/\s+/);
  all = {};
  for (i = 0; i < list.length; i++) {
    if (list[i].length > 0) all[list[i]] = true;
  }
  for (i = 0; i < remove.length; i++) {
    if (all.hasOwnProperty(remove[i])) {
      delete all[remove[i]];
    }
  }
  for (i = 0; i < add.length; i++) {
    all[add[i]] = true;
  }
  classes = "";
  for (cls in all) {
    classes += cls + " ";
  }
  node.className = classes;
}

/*
 * toggle_class
 *
 * Adds or removes a class from the node. If the parameter 'enabled' is not 
 * passed then the existence of the class will be toggled, otherwise it will be
 * included if enabled is true.
 */
function toggle_class(node, cls, enabled) {
  var classes = node.className;
  var list = classes.replace(/^\s+/, '').replace(/\s+$/, '').split(/\s+/);
  var found = false;
  for (var i = 0; i < list.length; i++) {
    if (list[i] == cls) {
      list.splice(i, 1);
      i--;
      found = true;
    }
  }
  if (typeof enabled == "undefined") {
    if (!found) list.push(cls);
  } else {
    if (enabled) list.push(cls);
  }
  node.className = list.join(" ");
}

/*
 * find_child
 *
 * Searches child nodes in depth first order and returns the first it finds
 * with the className specified.
 * TODO replace with querySelector
 */
function find_child(node, className) {
  var pattern;
  if (node == null || typeof node !== "object") {
    return null;
  }
  if (typeof className === "string") {
    pattern = new RegExp("\\b" + className + "\\b");
  } else {
    pattern = className;
  }
  if (node.nodeType == Node.ELEMENT_NODE && 
      pattern.test(node.className)) {
    return node;
  } else {
    var result = null;
    for (var i = 0; i < node.childNodes.length; i++) {
      result = find_child(node.childNodes[i], pattern);
      if (result != null) break;
    }
    return result;
  }
}

/*
 * find_parent
 *
 * Searches parent nodes outwards from the node and returns the first it finds
 * with the className specified.
 */
function find_parent(node, className) {
  var pattern;
  pattern = new RegExp("\\b" + className + "\\b");
  do {
    if (node.nodeType == Node.ELEMENT_NODE && 
        pattern.test(node.className)) {
      return node;
    }
  } while (node = node.parentNode);
  return null;
}

/*
 * find_parent_tag
 *
 * Searches parent nodes outwards from the node and returns the first it finds
 * with the tag name specified. HTML tags should be specified in upper case.
 */
function find_parent_tag(node, tag_name) {
  do {
    if (node.nodeType == Node.ELEMENT_NODE && node.tagName == tag_name) {
      return node;
    }
  } while (node = node.parentNode);
  return null;
}

/*
 * __toggle_help
 *
 * Uses the 'topic' property of the this object to
 * toggle display of a help topic.
 *
 * This function is not intended to be called directly.
 */
function __toggle_help(e) {
  if (!e) e = window.event;
  if (e.type === "keydown") {
    if (e.keyCode !== 13 && e.keyCode !== 32) {
      return;
    }
    // stop a submit or something like that
    e.preventDefault();
  }

  help_popup(this, this.getAttribute("data-topic"));
}

/*
 * help_button
 *
 * Makes a help button for the passed topic.
 */
function help_button(topic) {
  var btn = document.createElement("div");
  btn.className = "help";
  btn.setAttribute("data-topic", topic);
  btn.tabIndex = "0";
  btn.addEventListener("click", __toggle_help, false);
  btn.addEventListener("keydown", __toggle_help, false);
  return btn;
}

/*
 * add_cell
 *
 * Add a cell to the table row.
 */
function add_cell(row, node, cls, click_action) {
  var cell = row.insertCell(row.cells.length);
  if (node) cell.appendChild(node);
  if (cls && cls !== "") cell.className = cls;
  if (click_action) cell.onclick = click_action;
}

/*
 * add_cell
 *
 * Add a header cell to the table row.
 */
function add_header_cell(row, node, help_topic, cls) {
  var th = document.createElement("th");
  row.appendChild(th);
  if (node) th.appendChild(node);
  if (help_topic && help_topic !== "") th.appendChild(help_button(help_topic));
  if (cls && cls !== "") th.className = cls;
}

/*
 * add_text_cell
 *
 * Add a text cell to the table row.
 */
function add_text_cell(row, text, cls, click_action) {
  var node = null;
  if (typeof(text) != 'undefined') node = document.createTextNode(text);
  add_cell(row, node, cls, click_action);
}

/*
 * add_text_header_cell
 *
 * Add a text header cell to the table row.
 */
function add_text_header_cell(row, text, help_topic, cls) {
  var node = null;
  if (typeof(text) != 'undefined') {
    var nbsp = (help_topic ? "\u00A0" : "");
    var str = "" + text;
    var parts = str.split(/\n/);
    if (parts.length === 1) {
      node = document.createTextNode(str + nbsp);
    } else {
      node = document.createElement("span");
      for (var i = 0; i < parts.length; i++) {
        if (i !== 0) {
          node.appendChild(document.createElement("br"));
        }
        node.appendChild(document.createTextNode(parts[i]));
      }
    }
  }
  add_header_cell(row, node, help_topic, cls);
}
    /* END INCLUDED FILE "utilities.js" */
    
  
        var motifs = new Array();
        motifs["motif_1"] = new Motif("AfOr_Motif1", "amino-acid", "KLTAGKFFDMSLETFGDVLKT", "");
        motifs["motif_2"] = new Motif("AfOr_Motif2", "amino-acid", "FAHHACGQFRILGHWIQHLVD", "");
        motifs["motif_3"] = new Motif("AfOr_Motif3", "amino-acid", "AYMSDWYRLPPKKQK", "");
        motifs["motif_4"] = new Motif("AfOr_Motif4", "amino-acid", "IFMYCWPGDYLIDQSENVGNA", "");
        motifs["motif_5"] = new Motif("AfOr_Motif5", "amino-acid", "RWFLKPVGVWPYQNS", "");
        motifs["motif_6"] = new Motif("AfOr_Motif6", "amino-acid", "RIKRCVEHHQRAIEFCNRLEH", "");
        motifs["motif_7"] = new Motif("AfOr_Motif7", "amino-acid", "CIEHMEWDWKQVTREEDRQVM", "");
        motifs["motif_8"] = new Motif("AfOr_Motif8", "amino-acid", "QPICFMEMFGCTLNICMLGYC", "");
        motifs["motif_9"] = new Motif("AfOr_Motif9", "amino-acid", "PVQTSPYYEIVFGHQ", "");
        motifs["motif_10"] = new Motif("AfOr_Motif10", "amino-acid", "SFSYFNVLRQM", "");

        motifs.length = 10;
        var SEQ_MAX = 394;
        var TRANSLATE_DNA = "n";
        var DATABASE_TYPE = "amino-acid";
        var STRAND_HANDLING = "protein";
        
    
    /* START INCLUDED FILE "mast-to-html.js" */
        var wrap = undefined;//size to display on one line
        var wrap_timer;

        var loadedSequences = new Array();
        //draging details
        var moving_seq;
        var moving_annobox;
        var moving_left;
        var moving_width;
        var moving_both;

        //drag needles
        var dnl = null;
        var dnr = null;
        var drag_is_rc = undefined;
        //container
        var cont = null;

        function rewrap() {
          var previous_wrap = wrap;
          calculate_wrap();
          if (previous_wrap != wrap) {
            for (var seqid in loadedSequences) {
              //exclude inherited properties and undefined properties
              if (!loadedSequences.hasOwnProperty(seqid) || loadedSequences[seqid] === undefined) continue;
            
              var sequence = loadedSequences[seqid];
              var annobox = document.getElementById(seqid + "_annotation");
              var leftPos = parseInt(document.getElementById(seqid + "_dnl").firstChild.firstChild.nodeValue);
              var rightPos = parseInt(document.getElementById(seqid + "_dnr").firstChild.firstChild.nodeValue);
              var is_rc = undefined;
              if (STRAND_HANDLING === 'separate') {
                var fstrand = document.getElementById(seqid + "_fstrand");
                is_rc = !fstrand.checked;
              }
              set_data(leftPos, rightPos - leftPos + 1, is_rc, sequence, annobox);
            }
          }
          if (wrap_timer) {
            clearTimeout(wrap_timer);
          }
          wrap_timer = setTimeout("rewrap()", 5000);
        }

        function show_more(seqid) {
          if (wrap == undefined) rewrap();
          var seq_row = document.getElementById(seqid + "_blocks");
          var info_row = document.getElementById(seqid + "_info");
          var tbl = document.getElementById("tbl_sequences");
          if (info_row) {
            tbl.deleteRow(info_row.rowIndex);
            destroy_seq_handle(seqid, true);
            destroy_seq_handle(seqid, false);
            delete loadedSequences[seqid];
          } else {
            var sequence = new Sequence(seqid, TRANSLATE_DNA, DATABASE_TYPE, STRAND_HANDLING);

            loadedSequences[seqid] = sequence;
            info_row = tbl.insertRow(seq_row.rowIndex + 1);
            info_row.id = seqid + "_info";
            var cell = info_row.insertCell(0);
            cell.colSpan = (STRAND_HANDLING === 'separate' ? 6 : 4);
            cell.style.verticalAlign = "top";
            var width = Math.min(wrap, sequence.length); 
            var start = 1;
            var is_neg_strand = false;
            //center on the first hit
            if (sequence.hits.length > 0) {
              var hit = sequence.hits[0];
              is_neg_strand = hit.is_rc;
              start = Math.max(1, hit.pos + Math.round(hit.width / 2) - Math.round(width / 2));
              if ((start + width - 1) > sequence.length) {
                start = sequence.length - width + 1;
              }
            }
            create_info_section(cell, sequence, seqid, start, width, is_neg_strand);
            var blockCont = document.getElementById(seqid + "_block_container");
            //create sequence view handles
            create_seq_handle(blockCont, seqid, true, start, SEQ_MAX);
            create_seq_handle(blockCont, seqid, false, start + width-1, SEQ_MAX);
          }
        }

        function create_info_section(cell, sequence, seqid, start, width, is_neg_strand) {
          var help;
          var box = document.createElement('div');
          box.className = "box infobox";
          //generic info
          box.appendChild(document.createTextNode("Change the portion of annotated sequence by "));
          var bold_box = document.createElement('b');
          bold_box.appendChild(document.createTextNode("dragging the buttons"));
          box.appendChild(bold_box);
          box.appendChild(document.createTextNode("; hold shift to drag them individually."));
          box.appendChild(document.createElement('br'));
          box.appendChild(document.createElement('br'));
          //description
          var descTitle = document.createElement('h5');
          descTitle.appendChild(document.createTextNode("Comment:"));
          descTitle.className = "inlineTitle";
          box.appendChild(descTitle);
          box.appendChild(document.createTextNode(" " + sequence.desc + " "));
          box.appendChild(help_button("pop_sequence_description"));
          box.appendChild(document.createElement('br'));
          box.appendChild(document.createElement('br'));
          var cpvalueTitle = document.createElement('h5');
          cpvalueTitle.appendChild(document.createTextNode("Combined "));
          var italicp = document.createElement('i');
          italicp.appendChild(document.createTextNode("p"));
          cpvalueTitle.appendChild(italicp);
          cpvalueTitle.appendChild(document.createTextNode("-value:"));
          cpvalueTitle.className = "inlineTitle";
          box.appendChild(cpvalueTitle);
          if (sequence.cpvalue.indexOf("/") != -1) {
            var pos = sequence.cpvalue.indexOf("/");
            var forward = sequence.cpvalue.substring(0, pos);
            var reverse = sequence.cpvalue.substring(pos+1);
            var dim_forward;
            if (forward.indexOf("--") != -1) {
              dim_forward = true;
            } else if (reverse.indexOf("--") != -1) {
              dim_forward = false;
            } else {
              if ( (+forward) > (+reverse)) {
                dim_forward = true;
              } else {
                dim_forward = false;
              }
            }
            var span = document.createElement('span');
            span.className = "dim";
            if (dim_forward) {// dim the forward value
              span.appendChild(document.createTextNode(forward));
              box.appendChild(document.createTextNode(" "));
              box.appendChild(span);
              box.appendChild(document.createTextNode("/"));
              box.appendChild(document.createTextNode(reverse));
            } else {// dim the reverse value
              span.appendChild(document.createTextNode(reverse));
              box.appendChild(document.createTextNode(" "));
              box.appendChild(document.createTextNode(forward));
              box.appendChild(document.createTextNode("/"));
              box.appendChild(span);
            }
          } else {
            box.appendChild(document.createTextNode(" " + sequence.cpvalue));
          }
          box.appendChild(document.createTextNode(" "));
          box.appendChild(help_button("pop_combined_pvalue"));
          
          if (TRANSLATE_DNA === 'y') {
            box.appendChild(document.createElement('br'));
            box.appendChild(document.createElement('br'));
            var bestframeTitle = document.createElement('h5');
            bestframeTitle.appendChild(document.createTextNode("Best frame:"));
            bestframeTitle.className = "inlineTitle";
            box.appendChild(bestframeTitle);
            if (sequence.frame.indexOf("/") != -1) {
              var pos = sequence.frame.indexOf("/");
              var forward = sequence.frame.substring(0, pos);
              var reverse = sequence.frame.substring(pos+1);
              var dim_forward;
              if (forward.indexOf("--") != -1) {
                dim_forward = true;
              } else if (reverse.indexOf("--") != -1) {
                dim_forward = false;
              } else {
                if ( (+forward) > (+reverse)) {
                  dim_forward = true;
                } else {
                  dim_forward = false;
                }
              }
              var span = document.createElement('span');
              span.className = "dim";
              if (dim_forward) {// dim the forward value
                span.appendChild(document.createTextNode(forward));
                box.appendChild(document.createTextNode(" "));
                box.appendChild(span);
                box.appendChild(document.createTextNode("/"));
                box.appendChild(document.createTextNode(reverse));
              } else {// dim the reverse value
                span.appendChild(document.createTextNode(reverse));
                box.appendChild(document.createTextNode(" "));
                box.appendChild(document.createTextNode(forward));
                box.appendChild(document.createTextNode("/"));
                box.appendChild(span);
              }
            } else {
              box.appendChild(document.createTextNode(" " + sequence.frame));
            }
            box.appendChild(document.createTextNode(" "));
            box.appendChild(help_button("pop_frame"));
          }
          box.appendChild(document.createElement('br'));
          box.appendChild(document.createElement('br'));
          //sequence display
          var seqDispTitle = document.createElement('h5');
          seqDispTitle.appendChild(document.createTextNode("Annotated Sequence "));
          seqDispTitle.appendChild(help_button("pop_annotated_sequence"));
          box.appendChild(seqDispTitle);
          var show_rc_only = undefined;
          if (STRAND_HANDLING === 'separate') {
            show_rc_only = is_neg_strand;
            var myform = document.createElement('form');
            var fstrand = document.createElement('input');
            fstrand.id = seqid + "_fstrand";
            fstrand.type = "radio";
            fstrand.name = seqid + "_strand";
            fstrand.onclick = function(evt) {
              handle_strand_change(seqid);
            };
            var rstrand = document.createElement('input');
            rstrand.id = seqid + "_rstrand";
            rstrand.type = "radio";
            rstrand.name = seqid + "_strand";
            rstrand.onclick = function(evt) {
              handle_strand_change(seqid);
            };
            fstrand.checked = !show_rc_only;
            rstrand.checked = show_rc_only;
            myform.appendChild(fstrand);
            myform.appendChild(document.createTextNode("forward strand"));
            myform.appendChild(rstrand);
            myform.appendChild(document.createTextNode("reverse strand"));
            box.appendChild(myform);
          }
          var annobox = document.createElement('div');
          annobox.id = seqid + "_annotation";
          set_data(start, width, show_rc_only, sequence, annobox);
          box.appendChild(annobox);
          cell.appendChild(box);
        }

        function handle_strand_change(seqid) {
          var left = document.getElementById(seqid + "_dnl");
          var right = document.getElementById(seqid + "_dnr");
          var leftPos = parseInt(left.firstChild.firstChild.nodeValue);
          var rightPos = parseInt(right.firstChild.firstChild.nodeValue);
          var fstrand = document.getElementById(seqid + "_fstrand");
          var show_rc_only = !fstrand.checked;
          var data = loadedSequences[seqid];
          if (!data) {
            alert("Sequence not loaded?!");
          }
          var annobox = document.getElementById(seqid + "_annotation");
          set_data(leftPos, rightPos - leftPos + 1, show_rc_only, data, annobox);
        }

        function start_drag(seqid, mouse_on_left, move_both) {
          //first record what we are moving
          moving_left = mouse_on_left;
          moving_both = move_both;
          moving_seq = loadedSequences[seqid];
          if (!moving_seq) {
            alert("Sequence not loaded?!");
          }
          //get the container for movements to be judged against
          cont = document.getElementById(seqid + "_block_container");
          //get the div's that will be moved
          dnl = document.getElementById(seqid + "_dnl");
          dnr = document.getElementById(seqid + "_dnr");
          //get the div which has all the text containers that will be updated
          moving_annobox = document.getElementById(seqid + "_annotation");
          //calculate the space between handles
          moving_width = dnr.firstChild.firstChild.nodeValue - 
          dnl.firstChild.firstChild.nodeValue;
          if (STRAND_HANDLING === 'separate') {
            var fstrand = document.getElementById(seqid + "_fstrand");
            drag_is_rc = !fstrand.checked;
          } else {
            drag_is_rc = undefined;
          }
          //setup the events for draging
          document.onmousemove = handle_drag;
          document.onmouseup = finish_drag;
        }

        function set_data(start, width, show_rc_only, data, annobox) {
          var child = annobox.firstChild;
          var line_width = Math.min(wrap, width);
          var num_per_wrap = (TRANSLATE_DNA === 'y' ? 6 : 5);
          var end = start + width;
          for (var i = start; i < end; i += line_width, line_width = Math.min(wrap, end - i)) {
            for (var j = 0; j < num_per_wrap; ++j) {
              if (child) {
                while (child.firstChild) child.removeChild(child.firstChild);
              } else {
                switch (j) {
                case 0:
                  child = annobox_labels();
                  break;
                case 1:
                  child = annobox_hits();
                  break;
                case 2:
                  child = annobox_matches();
                  break;
                case 3:
                  if (TRANSLATE_DNA === 'y') {
                    child = annobox_translations();
                  } else {
                    child = annobox_sequence();
                  }
                  break;
                case 4:
                  if (TRANSLATE_DNA === 'y') {
                    child = annobox_sequence();
                  } else {
                    child = annobox_boundary();
                  }
                  break;
                case 5:
                  if (TRANSLATE_DNA === 'y') {
                    child = annobox_boundary();
                  }
                  break;
                }
                annobox.appendChild(child);
              }
              switch (j) {
              case 0:
                data.append_labels(child, i, line_width, show_rc_only);
                break;
              case 1:
                data.append_hits(child, i, line_width, show_rc_only);
                break;
              case 2:
                data.append_matches(child, i, line_width, show_rc_only);
                break;
              case 3:
                if (TRANSLATE_DNA === 'y') {
                  data.append_translation(child, i, line_width, show_rc_only);
                } else {
                  data.append_seq(child, i, line_width, show_rc_only);
                }
                break;
              case 4:
                if (TRANSLATE_DNA === 'y') {
                  data.append_seq(child, i, line_width, show_rc_only);
                } else {
                  data.append_boundary(child, i, line_width, show_rc_only);
                }
                break;
              case 5:
                if (TRANSLATE_DNA === 'y') {
                  data.append_boundary(child, i, line_width, show_rc_only);
                }
                break;
              }
              child = child.nextSibling;
            }
          }
          //clean up excess
          
          while (child) {
            var next = child.nextSibling;
            annobox.removeChild(child);
            child = next;
          }
        }
        
        function mouseCoords(ev) {
          ev = ev || window.event;
          if(ev.pageX || ev.pageY){ 
	          return {x:ev.pageX, y:ev.pageY}; 
	        } 
	        return { 
	          x:ev.clientX + document.body.scrollLeft - document.body.clientLeft, 
	          y:ev.clientY + document.body.scrollTop  - document.body.clientTop 
	        };
        }

        function setup() {
          rewrap();
          window.onresize = delayed_rewrap;
        }

        function calculate_wrap() {
          var est_wrap = 0;
          var page_width;
          if (window.innerWidth) {
            page_width = window.innerWidth;
          } else if (document.body) {
            page_width = document.body.clientWidth;
          } else {
            page_width = null;
          }
          if (page_width) {
            var ruler_width = document.getElementById("ruler").offsetWidth;
            est_wrap = Math.floor(page_width / ruler_width) * 5;
          }
          if (est_wrap > 20) {
            wrap = est_wrap - 20; 
          } else {
            wrap = 100;
          }
        }


        function delayed_rewrap() {
          if (wrap_timer) {
            clearTimeout(wrap_timer);
          }
          wrap_timer = setTimeout("rewrap()", 1000);
        }

        function showHidden(prefix) {
          document.getElementById(prefix + '_activator').style.display = 'none';
          document.getElementById(prefix + '_deactivator').style.display = 'block';
          document.getElementById(prefix + '_data').style.display = 'block';
        }
        function hideShown(prefix) {
          document.getElementById(prefix + '_activator').style.display = 'block';
          document.getElementById(prefix + '_deactivator').style.display = 'none';
          document.getElementById(prefix + '_data').style.display = 'none';
        }




        function annobox_labels() {
          var seqDispLabel = document.createElement('div');
          seqDispLabel.className = "sequence sequence_labels";
          seqDispLabel.style.height = "2.5em";
          return seqDispLabel;
        }

        function annobox_hits() {
          var seqDispHit = document.createElement('div');
          seqDispHit.className = "sequence";
          seqDispHit.style.height = "1.5em";
          return seqDispHit;
        }

        function annobox_matches() {
          var seqDispMatch = document.createElement('div');
          seqDispMatch.className = "sequence";
          seqDispMatch.style.height = "1.5em";
          return seqDispMatch;
        }

        function annobox_translations() {
          var seqDispXlate = document.createElement('div');
          seqDispXlate.className = "sequence";
          seqDispXlate.style.height = "1.5em";
          return seqDispXlate;
        }

        function annobox_sequence() {
          var seqDispSeq = document.createElement('div');
          seqDispSeq.className = "sequence";
          seqDispSeq.style.height = "1.5em";
          return seqDispSeq; 
        }
        function annobox_boundary() {
          var seqDispSeq = document.createElement('div');
          seqDispSeq.className = "sequence";
          seqDispSeq.style.height = "1.5em";
          return seqDispSeq; 
        }

        function create_seq_handle(container, seqid, isleft, pos, max) {
          var vbar = document.createElement('div');
          vbar.id = seqid + "_dn" + (isleft ? "l" : "r");
          vbar.className = "block_needle";
          //the needles sit between the sequence positions, so the left one sits at the start and the right at the end
          //this is why 1 is subtracted off the position for a left handle
          vbar.style.left = "" + ((isleft ? (pos - 1) : pos) / max * 100)+ "%";
          var label = document.createElement('div');
          label.className = "block_handle";
          label.appendChild(document.createTextNode("" + pos));
          label.style.cursor = 'pointer';
          label.title = "Drag to move the displayed range. Hold shift and drag to change " + (isleft ? "lower" : "upper") + " bound of the range.";
          vbar.appendChild(label);
          container.appendChild(vbar);
          label.onmousedown = function(evt) {
            evt = evt || window.event;
            start_drag(seqid, isleft, !(evt.shiftKey));
          };
        }

        function destroy_seq_handle(seqid, isleft) {
          var vbar = document.getElementById(seqid + "_dn" + (isleft ? "l" : "r"));
          var label = vbar.firstChild;
          label.onmousedown = null;
          vbar.parentNode.removeChild(vbar);
        }




        function calculate_width(obj) {
          return obj.clientWidth - (obj.style.paddingLeft ? obj.style.paddingLeft : 0) 
              - (obj.style.paddingRight ? obj.style.paddingRight : 0);
        }

        function calculate_drag_pos(ev) {
          var mouse = mouseCoords(ev);
          var dragable_length = calculate_width(cont);
          //I believe that the offset parent is the body
          //otherwise I would need to make this recursive
          //maybe clientLeft would work, but the explanation of
          //it is hard to understand and it apparently doesn't work
          //in firefox 2.
          var diff = mouse.x - cont.offsetLeft;
          if (diff < 0) diff = 0;
          if (diff > dragable_length) diff = dragable_length;
          var pos = Math.round(diff / dragable_length * (SEQ_MAX));
          return pos + 1;
        }

        function handle_drag(ev) {
          var pos = calculate_drag_pos(ev);
          update_needles(pos, moving_seq.length, false);
        }

        function finish_drag(ev) {
          document.onmousemove = null;
          document.onmouseup = null;
          var pos = calculate_drag_pos(ev);
          update_needles(pos, moving_seq.length, true);
        }

        function update_needles(pos, seqlen, updateTxt) {
          var leftPos = parseInt(dnl.firstChild.firstChild.nodeValue);
          var rightPos = parseInt(dnr.firstChild.firstChild.nodeValue);
          if (moving_both) {
            if (moving_left) {
              if ((pos + moving_width) > seqlen) {
                pos = seqlen - moving_width;
              }
              leftPos = pos;
              rightPos = pos + moving_width;
            } else {
              if (pos > seqlen) {
                pos = seqlen;
              } else if ((pos - moving_width) < 1) {
                pos = moving_width + 1;
              }
              leftPos = pos - moving_width;
              rightPos = pos;
            }
          } else {
            if (moving_left) {
              if (pos > rightPos) {
                pos = rightPos;
              }
              leftPos = pos;
            } else {
              if (pos < leftPos) {
                pos = leftPos;
              } else if (pos > seqlen) {
                pos = seqlen;
              }
              rightPos = pos;
            }
          }
          set_needles(SEQ_MAX, dnl, leftPos, dnr, rightPos);
          if (updateTxt) set_data(leftPos, rightPos - leftPos + 1, drag_is_rc, moving_seq, moving_annobox);
        }

        function set_needles(max, left, leftPos, right, rightPos) {
          //the needles are between the sequence positions
          //the left needle is before and the right needle after
          //think of it as an inclusive range...
          left.style.left = "" + ((leftPos -1) / max * 100)+ "%";
          left.firstChild.firstChild.nodeValue="" + leftPos;
          right.style.left = "" + (rightPos / max * 100)+ "%";
          right.firstChild.firstChild.nodeValue="" + rightPos;
        }


        function append_coloured_nucleotide_sequence(container, sequence) {
          var len = sequence.length;
          for (var i = 0; i < len; i++) {
            var colour = "black";
            switch (sequence.charAt(i)) {
            case 'A':
              colour = "red";
              break;
            case 'C':
              colour = "blue";
              break;
            case 'G':
              colour = "orange";
              break;
            case 'T':
              colour = "green";
              break;
            }
            var letter = document.createElement('span');
            letter.style.color = colour;
            letter.appendChild(document.createTextNode(sequence.charAt(i)));
            container.appendChild(letter);
          }
        }

        function append_coloured_peptide_sequence(container, sequence) {
          var len = sequence.length;
          for (var i = 0; i < len; i++) {
            var colour = "black";
            switch (sequence.charAt(i)) {
            case 'A':
            case 'C':
            case 'F':
            case 'I':
            case 'L':
            case 'V':
            case 'W':
            case 'M':
              colour = "blue";
              break;
            case 'N':
            case 'Q':
            case 'S':
            case 'T':
              colour = "green";
              break;
            case 'D':
            case 'E':
              colour = "magenta";
              break;
            case 'K':
            case 'R':
              colour = "red";
              break;
            case 'H':
              colour = "pink";
              break;
            case 'G':
              colour = "orange";
              break;
            case 'P':
              colour = "yellow";
              break;
            case 'Y':
              colour = "turquoise";
              break;
            }
            var letter = document.createElement('span');
            letter.style.color = colour;
            letter.appendChild(document.createTextNode(sequence.charAt(i)));
            container.appendChild(letter);
          }
        }

        /*
         * Finds the index of an item in a sorted array (a) that equals a key (k)
         * when compared using a comparator (c). If an exact match can not be found
         * then returns -(index+1), where index is the location that the item would be inserted.
         */
        function bsearch(a, c, k) {
          var low = 0;
          var high = a.length;
          while (low < high) {
            var mid = low + Math.floor((high - low) /2);
            if (c(a[mid], k) < 0) {
              low = mid + 1;
            } else {
              high = mid;
            }
          }
          if ((low < a.length) && (c(a[low], k) == 0)) {
            return low;
          } else {
            return -(low+1);
          }
        }

        //+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
        // Start Motif Object
        //+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
        function Motif(name, type, best_f, best_r) {
          this.name = name;
          this.is_nucleotide = (type === "nucleotide");
          this.best_f = best_f;
          if (best_r.length == 0) {
            var txt = best_f.split("");
            txt.reverse();
            best_r = txt.join("");
          }
          this.best_r = best_r;
          this.length = best_f.length;
        }
        //+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
        // End Motif Object
        //+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

        //+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
        // Start Seg Object
        //+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
        function Seg(start, segment) {
          this.start = parseInt(start);
          this.segment = segment;
        }

        function compare_seg_to_pos(seg, pos) {
          return seg.start - pos;
        }
        //+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
        // End Seg Object
        //+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

        //+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
        // Start Hit Object
        //+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
        function Hit(sequence_is_nucleotide, motif, pos, strand, pvalue, match, xlated) {
          //properties
          this.motif = motif;
          this.pos = parseInt(pos);
          this.width = 0;
          this.is_rc = (strand != "+");
          this.pvalue = pvalue;
          this.xlated = "";
          this.best = "";
          this.match = "";
          //functions
          this.find_overlap = Hit_find_overlap;
          //setup
          var seq;
          var m = match.replace(/ /g, "\u00A0");
          if (this.is_rc) seq = this.motif.best_r;
          else seq = this.motif.best_f;
          if (sequence_is_nucleotide == this.motif.is_nucleotide) {
            this.best = seq;
            this.match = m;
            this.xlated = xlated;
            this.width = motif.length;
          } else if (sequence_is_nucleotide) {
            this.width = motif.length * 3;
            for (var i = 0; i < motif.length; i++) {
              this.best += seq.charAt(i);
              this.best += "..";
              this.xlated += xlated.charAt(i);
              this.xlated += "..";
              this.match += m.charAt(i);
              this.match += "\u00A0\u00A0";
            }
          } else {
            throw "UNSUPPORTED_CONVERSION";
          }
        }

        function Hit_find_overlap(sequence_is_nucleotide, start, width) {
          if (this.pos < start) {
            if ((this.pos + this.width) > start) {
              return {hit: this, start: start, length: Math.min(width, (this.pos + this.width - start))};
            } else {
              return null;
            }
          } else if (this.pos < (start + width)) {
            return {hit: this, start: this.pos, length: Math.min(this.width, (start + width - this.pos))};
          }
          return null;
        }

        //+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
        // End Hit Object
        //+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

        //+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
        // Start Overlapping Hit Iterator
        //+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
        function OLHIterator(sequence, start, width, is_rc) {
          //properties
          this.sequence = sequence;
          this.start = start;
          this.width = width;
          this.is_rc = is_rc;
          this.both = (is_rc === undefined);
          this.index = 0;
          this.nextO = null;
          //methods
          this.next = OLHIterator_next;
          this.has_next = OLHIterator_has_next;
          //setup
          // find the first hit which overlaps the range
          for (; this.index < this.sequence.hits.length; this.index++) {
            var hit = this.sequence.hits[this.index];
            if (!this.both && this.is_rc != hit.is_rc) continue;
            if ((this.nextO = hit.find_overlap(this.sequence.is_nucleotide, this.start, this.width)) != null) break;
          }
        }
        
        function OLHIterator_next() {
          if (this.nextO == null) throw "NO_NEXT_ELEMENT";
          var current = this.nextO;
          this.nextO = null;
          for (this.index = this.index + 1; this.index < this.sequence.hits.length; this.index++) {
            var hit = this.sequence.hits[this.index];
            if (!this.both && this.is_rc != hit.is_rc) continue;
            this.nextO = hit.find_overlap(this.sequence.is_nucleotide, this.start, this.width);
            break;
          }
          return current;
        }
        
        function OLHIterator_has_next() {
          return (this.nextO != null);
        }

        //+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
        // End Overlapping Hit Iterator
        //+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

        //+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
        // Start Sequence Object
        //+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
        function Sequence(seqid, translate_dna, database_type, strand_handling) {
          //properties
          this.has_frame = (translate_dna === 'y');
          this.db_dna = (database_type === 'nucleotide');
          this.has_strand = (this.db_dna && strand_handling !== 'separate');
          this.length = parseInt(document.getElementById(seqid + "_len").value);
          this.desc = document.getElementById(seqid + "_desc").value;
          this.cpvalue = document.getElementById(seqid + "_combined_pvalue").value;
          if (this.has_frame) {
            this.frame = document.getElementById(seqid + "_frame").value;
          }
          this.is_nucleotide = (document.getElementById(seqid + "_type").value === "nucleotide");
          this.segs = new Array(); //sorted list of segs
          this.hits = new Array(); //sorted list of hits
          //functions
          this.get_overlapping_hits = Sequence_get_overlapping_hits;
          this.append_seq = Sequence_append_seq;
          this.append_translation = Sequence_append_translation;
          this.append_hits = Sequence_append_hits;
          this.append_matches = Sequence_append_matches;
          this.append_labels = Sequence_append_labels;
          this.append_boundary = Sequence_append_boundary;
          //init
          //made this parser much more permissive as a new
          //version of libxml2 broke the translate call I was
          //using to remove whitespace characters
          var mysegs = document.getElementById(seqid + "_segs");
          var tokens = mysegs.value.split(/\s+/);
          var offsetnum = "";
          var seqchunk = "";
          for (var i = 0; i < tokens.length; i++) {
            var token = tokens[i];
            if (token == "") continue;
            if (token.match(/\d+/)) {
              if (offsetnum != "" && seqchunk != "") {
                this.segs.push(new Seg(offsetnum, seqchunk));
              }
              offsetnum = parseInt(token, 10);
              seqchunk = "";
              continue;
            }
            seqchunk += token;
          }
          if (offsetnum != "" && seqchunk != "") {
            this.segs.push(new Seg(offsetnum, seqchunk));
          }
          var myhits = document.getElementById(seqid + "_hits");
          lines = myhits.value.split(/\n/);
          for (var i in lines) {
            //exclude inherited properties and undefined properties
            if (!lines.hasOwnProperty(i) || lines[i] === undefined) continue;
            
            var line = lines[i];
            var chunks = line.split(/\t/);
            if (chunks.length != 6) continue;
            var pos = chunks[0];
            var motif = motifs[chunks[1]];
            var strand = chunks[2];
            var pvalue = chunks[3];
            var match = chunks[4];
            var xlated = chunks[5];
            this.hits.push(new Hit(this.is_nucleotide, motif, pos, strand, pvalue, match, xlated));
          }
        }

        function Sequence_get_overlapping_hits(start, width, is_rc) {
          return new OLHIterator(this, start, width, is_rc);
        }

        function Sequence_append_seq(container, start, width, is_rc) {
          if (start > this.length) {
            alert("start: " + start + " length: " + this.length);
            throw "INDEX_OUT_OF_BOUNDS";
          }
          if ((start + width - 1) > this.length) {
            alert("start: " + start + " width: " + width + " length: " + this.length);
            throw "RANGE_OUT_OF_BOUNDS";
          }
          //make a sub container to put the sequence in
          var mycontainer = document.createElement('span');
          // find where a seg starting at start would be
          var i = bsearch(this.segs, compare_seg_to_pos, start);
          var seg;
          var sequence = "";
          if (i < -1) {
            //possible partial segment, need to handle first
            i = -(i + 1);
            seg = this.segs[i-1];
            if ((seg.start + seg.segment.length) > start) {
              var seg_offset = start - seg.start;
              var seg_width = Math.min(width, seg.segment.length - seg_offset);
              sequence += seg.segment.substring(seg_offset, seg_offset + seg_width);
            }
          } else if (i == -1) {
            //gap, with following segment, normal state at start of iteration
            i = 0;
          } 
          for (;i < this.segs.length; i++) {
            seg = this.segs[i];
            var gap_width = Math.min(width - sequence.length, seg.start - (start + sequence.length));
            for (; gap_width > 0; gap_width--) sequence += '-';
            var seg_width = Math.min(width - sequence.length, seg.segment.length);
            if (seg_width == 0) break;
            sequence += seg.segment.substring(0, seg_width);
          }
          while (sequence.length < width) sequence += '-';
          // calculate which parts are aligned with hits and output them in colour
          var pos = start;
          var iter = this.get_overlapping_hits(start, width, is_rc);
          while (iter.has_next()) {
            var o = iter.next();
            var from, to;
            if (o.start > pos) {
              from = pos - start;
              to = o.start - start;
              var subseq = sequence.substring(from, to);
              var greytxt = document.createElement('span');
              greytxt.style.color = 'grey';
              greytxt.appendChild(document.createTextNode(subseq));
              mycontainer.appendChild(greytxt);
              pos = o.start;
            }
            from = pos - start;
            to = from + o.length;
            var motifseq = sequence.substring(from, to);
            if (this.is_nucleotide) {
              append_coloured_nucleotide_sequence(mycontainer, motifseq);
            } else {
              append_coloured_peptide_sequence(mycontainer, motifseq);
            }
            pos += o.length;
          }
          if (pos < (start + width)) {
            var greytxt = document.createElement('span');
            greytxt.style.color = 'grey';
            greytxt.appendChild(document.createTextNode(sequence.substring(pos - start)));
            mycontainer.appendChild(greytxt);
          }
          container.appendChild(mycontainer);
        }

        function Sequence_append_translation(container, start, width, is_rc) {
          if (start > this.length) {
            alert("start: " + start + " length: " + this.length);
            throw "INDEX_OUT_OF_BOUNDS";
          }
          if ((start + width - 1) > this.length) {
            alert("start: " + start + " width: " + width + " length: " + this.length);
            throw "RANGE_OUT_OF_BOUNDS";
          }
          //make a sub container to put the sequence in
          var mycontainer = document.createElement('span');
          // calculate which parts are aligned with hits and output them in colour
          var pos = start;
          var iter = this.get_overlapping_hits(start, width, is_rc);
          while (iter.has_next()) {
            var o = iter.next();
            var space = "";
            var from, to;
            while (o.start > pos) {
              space += "\u00A0";
              ++pos;
            }
            if (space.length > 0) {
              var spacer = document.createElement('span');
              spacer.appendChild(document.createTextNode(space));
              mycontainer.appendChild(spacer);
            }
            from = o.start - o.hit.pos;
            to = from + o.length;
            var motifseq = o.hit.xlated.substring(from, to);
            if (o.hit.motif.is_nucleotide) {
              append_coloured_nucleotide_sequence(mycontainer, motifseq);
            } else {
              append_coloured_peptide_sequence(mycontainer, motifseq);
            }
            pos += o.length;
          }

          container.appendChild(mycontainer);
        }

        function Sequence_append_matches(container, start, width, is_rc) {
          if (start > this.length) {
            alert("start: " + start + " length: " + this.length);
            throw "INDEX_OUT_OF_BOUNDS";
          }
          if ((start + width - 1) > this.length) {
            alert("start: " + start + " width: " + width + " length: " + this.length);
            throw "RANGE_OUT_OF_BOUNDS";
          }
          //make a sub container to put the sequence in
          var mycontainer = document.createElement('span');
          var pos = start;
          var text = "";
          var iter = this.get_overlapping_hits(start, width, is_rc);
          while (iter.has_next()) {
            var o = iter.next();
            var space = "";
            var from, to;
            while (o.start > pos) {
              text += "\u00A0";
              ++pos;
            }
            from = o.start - o.hit.pos;
            to = from + o.length;
            var motifseq = o.hit.match.substring(from, to);
            text += motifseq
            pos += o.length;
          }
          mycontainer.appendChild(document.createTextNode(text));
          container.appendChild(mycontainer);
        }

        function Sequence_append_hits(container, start, width, is_rc) {
          if (start > this.length) {
            alert("start: " + start + " length: " + this.length);
            throw "INDEX_OUT_OF_BOUNDS";
          }
          if ((start + width - 1) > this.length) {
            alert("start: " + start + " width: " + width + " length: " + this.length);
            throw "RANGE_OUT_OF_BOUNDS";
          }
          //make a sub container to put the sequence in
          var mycontainer = document.createElement('span');
          // calculate which parts are aligned with hits and output them in colour
          var pos = start;
          var iter = this.get_overlapping_hits(start, width, is_rc);
          while (iter.has_next()) {
            var o = iter.next();
            var space = "";
            var from, to;
            while (o.start > pos) {
              space += "\u00A0";
              ++pos;
            }
            if (space.length > 0) {
              var spacer = document.createElement('span');
              spacer.appendChild(document.createTextNode(space));
              mycontainer.appendChild(spacer);
            }
            from = o.start - o.hit.pos;
            to = from + o.length;
            var motifseq = o.hit.best.substring(from, to);
            if (o.hit.motif.is_nucleotide) {
              append_coloured_nucleotide_sequence(mycontainer, motifseq);
            } else {
              append_coloured_peptide_sequence(mycontainer, motifseq);
            }
            pos += o.length;
          }

          container.appendChild(mycontainer);
        }

        function Sequence_append_labels(container, start, width, is_rc) {
          if (start > this.length) {
            alert("start: " + start + " length: " + this.length);
            throw "INDEX_OUT_OF_BOUNDS";
          }
          if ((start + width - 1) > this.length) {
            alert("start: " + start + " width: " + width + " length: " + this.length);
            throw "RANGE_OUT_OF_BOUNDS";
          }
          //create a table (ye gods...)
          var oTable = document.createElement("table");
          var oRow = oTable.insertRow(oTable.rows.length);

          // calculate where to put the labels
          var pos = start;
          var cellindex = 0;
          var iter = this.get_overlapping_hits(start, width, is_rc);
          while (iter.has_next()) {
            var o = iter.next();
            var motif_center = Math.floor(o.start + o.length / 2);
            var spacer = "";
            while (pos < motif_center) {
              spacer += "\u00A0";
              pos++;
            }
            var cell1 = oRow.insertCell(cellindex++);
            cell1.appendChild(document.createTextNode(spacer));
            //add one for the div
            pos++;
            var cell2 = oRow.insertCell(cellindex++);
            //create the div that holds the label divs
            var div_container = document.createElement('div');
            div_container.className = "label_container";
            cell2.appendChild(div_container);
            //create the top label
            var top_label = "";
            if (this.has_strand || this.has_frame) {
              top_label += "(";
              if (this.has_strand) {
                if (o.hit.is_rc) {
                  top_label += "-";
                } else {
                  top_label += "+";
                }
              }
              if (this.has_frame) {
                switch ((o.hit.pos - 1) % 3) {
                  case 0:
                  top_label += "a";
                  break;
                  case 1:
                  top_label += "b";
                  break;
                  default:
                  top_label += "c";
                  break;
                }
              }
              top_label += ") ";
            }
            if (o.hit.motif.name.match(/^\d+$/)) {
              top_label += "Motif " + o.hit.motif.name;
            } else {
              top_label += o.hit.motif.name;
            }
            var div_top_label = document.createElement('div');
            div_top_label.className = "sequence_label sequence_label_top";
            div_top_label.style.width = "" + top_label.length + "em";
            div_top_label.style.left = "-" + (top_label.length / 2) + "em";
            div_top_label.appendChild(document.createTextNode(top_label));
            //create the bottom label
            var bottom_label = o.hit.pvalue;
            var div_bottom_label = document.createElement('div');
            div_bottom_label.className = "sequence_label sequence_label_bottom";
            div_bottom_label.style.width = "" + bottom_label.length + "em";
            div_bottom_label.style.left = "-" + (bottom_label.length / 2) + "em";
            div_bottom_label.appendChild(document.createTextNode(bottom_label));
            //add the label divs to the positioned container
            div_container.appendChild(div_top_label);
            div_container.appendChild(div_bottom_label);
          }
          container.appendChild(oTable);

        }

        function Sequence_append_boundary(container, start, width, is_rc) {
          if (start > this.length) {
            alert("start: " + start + " length: " + this.length);
            throw "INDEX_OUT_OF_BOUNDS";
          }
          if ((start + width - 1) > this.length) {
            alert("start: " + start + " width: " + width + " length: " + this.length);
            throw "RANGE_OUT_OF_BOUNDS";
          }
          //make a sub container to put the sequence in
          var mycontainer = document.createElement('span');
          var pos = start;
          var text = "";
          var iter = this.get_overlapping_hits(start, width, is_rc);
          while (iter.has_next()) {
            var o = iter.next();
            var end;
            while (o.start > pos) {
              text += "\u00A0";
              ++pos;
            }
            if (o.start == o.hit.pos) {
              text += "\\";
              ++pos;
            }
            end = o.start + o.length - 1;
            while (end > pos) {
              text += "_";
              ++pos;
            }
            if (end == (o.hit.pos + o.hit.width -1)) {
              text += "/"
            } else {
              text += "_"
            }
            ++pos;
          }
          mycontainer.appendChild(document.createTextNode(text));
          container.appendChild(mycontainer);
        }
        //+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
        // End Sequence Object
        //+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
    /* END INCLUDED FILE "mast-to-html.js" */
    
  </script>
</head>
<body onload="javascript:setup()">
<div class="pop_content" id="pop_db_name">
<p>The name of the sequence database file.</p>
<div class="pop_close">[<a href="javascript:help_popup()">close</a> ]</div>
</div>
<div class="pop_content" id="pop_db_seqs">
<p>The number of sequences in the database.</p>
<div class="pop_close">[<a href="javascript:help_popup()">close</a> ]</div>
</div>
<div class="pop_content" id="pop_db_residues">
<p>The number of residues in the sequence database.</p>
<div class="pop_close">[<a href="javascript:help_popup()">close</a> ]</div>
</div>
<div class="pop_content" id="pop_db_lastmod">
<p>The date of the last modification to the sequence database.</p>
<div class="pop_close">[<a href="javascript:help_popup()">close</a> ]</div>
</div>
<div class="pop_content" id="pop_motif_id">
<p>The name of the motif. If the motif has been removed or removal is 
        recommended to avoid highly similar motifs then it will be displayed
        in red text.</p>
<div class="pop_close">[<a href="javascript:help_popup()">close</a> ]</div>
</div>
<div class="pop_content" id="pop_motif_width">
<p>The width of the motif. No gaps are allowed in motifs supplied to MAST
        as it only works for motifs of a fixed width.</p>
<div class="pop_close">[<a href="javascript:help_popup()">close</a> ]</div>
</div>
<div class="pop_content" id="pop_motif_bmatch">
<p>The sequence that would achieve the best possible match score and its
        reverse complement for nucleotide motifs.</p>
<div class="pop_close">[<a href="javascript:help_popup()">close</a> ]</div>
</div>
<div class="pop_content" id="pop_motif_similarity">
<p>MAST computes the pairwise correlations between each pair of motifs. 
        The correlation between two motifs is the maximum sum of Pearson's 
        correlation coefficients for aligned columns divided by the width of 
        the shorter motif. The maximum is found by trying all alignments of the
        two motifs. Motifs with correlations below 0.60 have little effect on
        the accuracy of the combined scores. Pairs of motifs with higher
        correlations should be removed from the query. Correlations above the
        supplied threshold are shown in red text. </p>
<div class="pop_close">[<a href="javascript:help_popup()">close</a> ]</div>
</div>
<div class="pop_content" id="pop_nos">
<p>This diagram shows the normal spacing of the motifs specified to MAST.</p>
<div class="pop_close">[<a href="javascript:help_popup()">close</a> ]</div>
</div>
<div class="pop_content" id="pop_sequence">
<p>The name of the sequence. This maybe be linked to search a sequence database for the sequence name.</p>
<div class="pop_close">[<a href="javascript:help_popup()">close</a> ]</div>
</div>
<div class="pop_content" id="pop_evalue">
<p>
        The <a href="#evalue_doc"><i>E</i>-value</a> of the sequence. For DNA
        only; if strands were scored seperately then there will be two 
        <i>E</i>-values for the sequence seperated by a "/". The score for the
        provided sequence will be first and the score for the reverse-complement
        will be second.
      </p>
<div class="pop_close">[<a href="javascript:help_popup()">close</a> ]</div>
</div>
<div class="pop_content" id="pop_diagram" style="width:500px;">
<p>The block diagram shows the best non-overlapping tiling of motif matches on the sequence.</p>
<ul style="padding-left: 1em; margin-top:5px;">
<li>The length of the line shows the length of a sequence relative to all the other sequences.</li>
<li>A block is shown where the <a href="#pos_pvalue_doc">positional <i>p</i>-value</a>
          of a motif is less (more significant) than the significance threshold which is 0.0001 by default.</li>
<li>If a significant motif match (as specified above) overlaps other significant motif matches then 
          it is only displayed as a block if its <a href="#pos_pvalue_doc">positional <i>p</i>-value</a> 
          is less (more significant) then the product of the <a href="#pos_pvalue_doc">positional 
          <i>p</i>-values</a> of the significant matches that it overlaps.</li>
<li>The position of a block shows where a motif has matched the sequence.</li>
<li>The width of a block shows the width of the motif relative to the length of the sequence.</li>
<li>The colour and border of a block identifies the matching motif as in the legend.</li>
<li>The height of a block gives an indication of the significance of the match as 
          taller blocks are more significant. The height is calculated to be proportional 
          to the negative logarithm of the <a href="#pos_pvalue_doc">positional <i>p</i>-value</a>, 
          truncated at the height for a <i>p</i>-value of 1e-10.</li>
<li>Hovering the mouse cursor over the block causes the display of the motif name 
            and other details in the hovering text.</li>
<li>DNA only; blocks displayed above the line are a match on the given DNA, whereas blocks 
          displayed below the line are matches to the reverse-complement of the given DNA.</li>
<li>DNA only; when strands are scored separately then blocks may overlap on opposing strands.</li>
</ul>
<div class="pop_close">[<a href="javascript:help_popup()">close</a> ]</div>
</div>
<div class="pop_content" id="pop_sequence_description">
<p>The description appearing after the identifier in the fasta file used to specify the sequence.</p>
<div class="pop_close">[<a href="javascript:help_popup()">close</a> ]</div>
</div>
<div class="pop_content" id="pop_combined_pvalue">
<p>The <a href="#combined_pvalue_doc">combined <i>p</i>-value</a> of the
        sequence. DNA only; if strands were scored seperately then there will be
        two <i>p</i>-values for the sequence seperated by a "/". The score for
        the provided sequence will be first and the score for the
        reverse-complement will be second.</p>
<div class="pop_close">[<a href="javascript:help_popup()">close</a> ]</div>
</div>
<div class="pop_content" id="pop_frame">
<p>This indicates the offset used for translation of the DNA.</p>
<div class="pop_close">[<a href="javascript:help_popup()">close</a> ]</div>
</div>
<div class="pop_content" id="pop_annotated_sequence">
<p>The annotated sequence shows a portion of the sequence with the
        matching motif sequences displayed above. The displayed portion of the
        sequence can be modified by sliding the two buttons below the sequence
        block diagram so that the portion you want to see is between the two
        needles attached to the buttons. By default the two buttons move
        together but you can drag one individually by holding shift before you
        start the drag. If the strands were scored seperately then they can't
        be both displayed at once due to overlaps and so a radio button offers
        the choice of strand to display.</p>
<div class="pop_close">[<a href="javascript:help_popup()">close</a> ]</div>
</div>
<div id="top" class="pad1">
<div class="prog_logo big">
<img src="http://meme-suite.org/doc/images/mast_icon.png" alt="MAST Logo"><h1>MAST</h1>
<h2>Motif Alignment &amp; Search Tool</h2>
</div>
<p class="spaced">
        For further information on how to interpret these results or to get a 
        copy of the MEME software please access 
        <a href="http://meme-suite.org/">http://meme-suite.org</a>. 
      </p>
<p>If you use MAST in your research, please cite the following paper:<br><span class="citation">
          Timothy L. Bailey and Michael Gribskov,
          "Combining evidence using p-values: application to sequence homology searches",
          <i>Bioinformatics</i>, <b>14</b>(1):48-54, 1998.
          <a href="http://bioinformatics.oxfordjournals.org/content/14/1/48">[pdf]</a></span></p>
</div>
<div id="navigation" class="pad2">
<a class="jump" href="#inputs">Inputs</a>
        |  
      <a class="jump" href="#results">Search Results</a>
        |  
      <a class="jump" href="#program">Program information</a>
        |  
      <a class="jump" href="#doc">Explanation</a>
</div>
<table id="inputs" width="100%" border="0" cellspacing="1" cellpadding="4" bgcolor="#FFFFFF"><tr>
<td><h2 class="mainh">Inputs</h2></td>
<td align="right" valign="bottom"><a href="#top">Top</a></td>
</tr></table>
<div class="box">
<h4 id="databases">Sequence Databases</h4>
<div class="pad">
<p>The following sequence database was supplied to MAST.</p>
<table class="padded-table" border="0">
<col>
<col>
<col>
<thead><tr>
<th style="text-align:left;">Database <div class="help" onclick="help_popup(this,'pop_db_name')"></div>
</th>
<th>Sequence Count <div class="help" onclick="help_popup(this,'pop_db_seqs')"></div>
</th>
<th>Residue Count <div class="help" onclick="help_popup(this,'pop_db_residues')"></div>
</th>
<th>Last Modified <div class="help" onclick="help_popup(this,'pop_db_lastmod')"></div>
</th>
</tr></thead>
<tbody><tr>
<td>exonerate.txt.ORs.starRemoved.pep</td>
<td class="tnum">2</td>
<td class="tnum">514</td>
<td>Mon Oct  5 14:48:51 2020</td>
</tr></tbody>
<tfoot><tr>
<th style="text-align:left; padding:5px 10px;">Total</th>
<td class="tnum">2</td>
<td class="tnum">514</td>
<td> </td>
</tr></tfoot>
</table>
</div>
<h4 id="motifs">Motifs</h4>
<div class="pad">
<p>The following motifs were supplied to MAST from "/media/snehal/Data1/my_tools/insectOR//tools/motifs/AfOr_motifs" last modified on Mon Jun 19 13:24:49 2017.
          </p>
<table class="padded-table" border="0">
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<thead>
<tr>
<th> </th>
<th> </th>
<th> </th>
<th colspan="10">Similarity <div class="help" onclick="help_popup(this,'pop_motif_similarity')"></div>
</th>
</tr>
<tr>
<th>Motif <div class="help" onclick="help_popup(this,'pop_motif_id')"></div>
</th>
<th>Width <div class="help" onclick="help_popup(this,'pop_motif_width')"></div>
</th>
<th>Best possible match <div class="help" onclick="help_popup(this,'pop_motif_bmatch')"></div>
</th>
<th>AfOr_Motif1</th>
<th>AfOr_Motif2</th>
<th>AfOr_Motif3</th>
<th>AfOr_Motif4</th>
<th>AfOr_Motif5</th>
<th>AfOr_Motif6</th>
<th>AfOr_Motif7</th>
<th>AfOr_Motif8</th>
<th>AfOr_Motif9</th>
<th>AfOr_Motif10</th>
</tr>
</thead>
<tbody>
<tr>
<td>AfOr_Motif1</td>
<td>21</td>
<td class="sequence">
<span style="color:red">K</span><span style="color:blue">L</span><span style="color:green">T</span><span style="color:blue">A</span><span style="color:orange">G</span><span style="color:red">K</span><span style="color:blue">F</span><span style="color:blue">F</span><span style="color:magenta">D</span><span style="color:blue">M</span><span style="color:green">S</span><span style="color:blue">L</span><span style="color:magenta">E</span><span style="color:green">T</span><span style="color:blue">F</span><span style="color:orange">G</span><span style="color:magenta">D</span><span style="color:blue">V</span><span style="color:blue">L</span><span style="color:red">K</span><span style="color:green">T</span>
</td>
<td>-</td>
<td>0.30</td>
<td>0.25</td>
<td>0.25</td>
<td>0.26</td>
<td>0.27</td>
<td>0.11</td>
<td>0.28</td>
<td>0.29</td>
<td>0.35</td>
</tr>
<tr>
<td>AfOr_Motif2</td>
<td>21</td>
<td class="sequence">
<span style="color:blue">F</span><span style="color:blue">A</span><span style="color:pink">H</span><span style="color:pink">H</span><span style="color:blue">A</span><span style="color:blue">C</span><span style="color:orange">G</span><span style="color:green">Q</span><span style="color:blue">F</span><span style="color:red">R</span><span style="color:blue">I</span><span style="color:blue">L</span><span style="color:orange">G</span><span style="color:pink">H</span><span style="color:blue">W</span><span style="color:blue">I</span><span style="color:green">Q</span><span style="color:pink">H</span><span style="color:blue">L</span><span style="color:blue">V</span><span style="color:magenta">D</span>
</td>
<td>0.30</td>
<td>-</td>
<td>0.20</td>
<td>0.29</td>
<td>0.24</td>
<td>0.22</td>
<td>0.11</td>
<td>0.24</td>
<td>0.22</td>
<td>0.43</td>
</tr>
<tr>
<td>AfOr_Motif3</td>
<td>15</td>
<td class="sequence">
<span style="color:blue">A</span><span style="color:turquoise">Y</span><span style="color:blue">M</span><span style="color:green">S</span><span style="color:magenta">D</span><span style="color:blue">W</span><span style="color:turquoise">Y</span><span style="color:red">R</span><span style="color:blue">L</span><span style="color:yellow">P</span><span style="color:yellow">P</span><span style="color:red">K</span><span style="color:red">K</span><span style="color:green">Q</span><span style="color:red">K</span>
</td>
<td>0.25</td>
<td>0.20</td>
<td>-</td>
<td>0.26</td>
<td>0.17</td>
<td>0.22</td>
<td>0.17</td>
<td>0.17</td>
<td>0.14</td>
<td>0.17</td>
</tr>
<tr>
<td>AfOr_Motif4</td>
<td>21</td>
<td class="sequence">
<span style="color:blue">I</span><span style="color:blue">F</span><span style="color:blue">M</span><span style="color:turquoise">Y</span><span style="color:blue">C</span><span style="color:blue">W</span><span style="color:yellow">P</span><span style="color:orange">G</span><span style="color:magenta">D</span><span style="color:turquoise">Y</span><span style="color:blue">L</span><span style="color:blue">I</span><span style="color:magenta">D</span><span style="color:green">Q</span><span style="color:green">S</span><span style="color:magenta">E</span><span style="color:green">N</span><span style="color:blue">V</span><span style="color:orange">G</span><span style="color:green">N</span><span style="color:blue">A</span>
</td>
<td>0.25</td>
<td>0.29</td>
<td>0.26</td>
<td>-</td>
<td>0.24</td>
<td>0.22</td>
<td>0.16</td>
<td>0.23</td>
<td>0.25</td>
<td>0.25</td>
</tr>
<tr>
<td>AfOr_Motif5</td>
<td>15</td>
<td class="sequence">
<span style="color:red">R</span><span style="color:blue">W</span><span style="color:blue">F</span><span style="color:blue">L</span><span style="color:red">K</span><span style="color:yellow">P</span><span style="color:blue">V</span><span style="color:orange">G</span><span style="color:blue">V</span><span style="color:blue">W</span><span style="color:yellow">P</span><span style="color:turquoise">Y</span><span style="color:green">Q</span><span style="color:green">N</span><span style="color:green">S</span>
</td>
<td>0.26</td>
<td>0.24</td>
<td>0.17</td>
<td>0.24</td>
<td>-</td>
<td>0.15</td>
<td>0.07</td>
<td>0.27</td>
<td>0.14</td>
<td>0.26</td>
</tr>
<tr>
<td>AfOr_Motif6</td>
<td>21</td>
<td class="sequence">
<span style="color:red">R</span><span style="color:blue">I</span><span style="color:red">K</span><span style="color:red">R</span><span style="color:blue">C</span><span style="color:blue">V</span><span style="color:magenta">E</span><span style="color:pink">H</span><span style="color:pink">H</span><span style="color:green">Q</span><span style="color:red">R</span><span style="color:blue">A</span><span style="color:blue">I</span><span style="color:magenta">E</span><span style="color:blue">F</span><span style="color:blue">C</span><span style="color:green">N</span><span style="color:red">R</span><span style="color:blue">L</span><span style="color:magenta">E</span><span style="color:pink">H</span>
</td>
<td>0.27</td>
<td>0.22</td>
<td>0.22</td>
<td>0.22</td>
<td>0.15</td>
<td>-</td>
<td>0.22</td>
<td>0.14</td>
<td>0.20</td>
<td>0.33</td>
</tr>
<tr>
<td>AfOr_Motif7</td>
<td>21</td>
<td class="sequence">
<span style="color:blue">C</span><span style="color:blue">I</span><span style="color:magenta">E</span><span style="color:pink">H</span><span style="color:blue">M</span><span style="color:magenta">E</span><span style="color:blue">W</span><span style="color:magenta">D</span><span style="color:blue">W</span><span style="color:red">K</span><span style="color:green">Q</span><span style="color:blue">V</span><span style="color:green">T</span><span style="color:red">R</span><span style="color:magenta">E</span><span style="color:magenta">E</span><span style="color:magenta">D</span><span style="color:red">R</span><span style="color:green">Q</span><span style="color:blue">V</span><span style="color:blue">M</span>
</td>
<td>0.11</td>
<td>0.11</td>
<td>0.17</td>
<td>0.16</td>
<td>0.07</td>
<td>0.22</td>
<td>-</td>
<td>0.16</td>
<td>0.17</td>
<td>0.19</td>
</tr>
<tr>
<td>AfOr_Motif8</td>
<td>21</td>
<td class="sequence">
<span style="color:green">Q</span><span style="color:yellow">P</span><span style="color:blue">I</span><span style="color:blue">C</span><span style="color:blue">F</span><span style="color:blue">M</span><span style="color:magenta">E</span><span style="color:blue">M</span><span style="color:blue">F</span><span style="color:orange">G</span><span style="color:blue">C</span><span style="color:green">T</span><span style="color:blue">L</span><span style="color:green">N</span><span style="color:blue">I</span><span style="color:blue">C</span><span style="color:blue">M</span><span style="color:blue">L</span><span style="color:orange">G</span><span style="color:turquoise">Y</span><span style="color:blue">C</span>
</td>
<td>0.28</td>
<td>0.24</td>
<td>0.17</td>
<td>0.23</td>
<td>0.27</td>
<td>0.14</td>
<td>0.16</td>
<td>-</td>
<td>0.21</td>
<td>0.31</td>
</tr>
<tr>
<td>AfOr_Motif9</td>
<td>15</td>
<td class="sequence">
<span style="color:yellow">P</span><span style="color:blue">V</span><span style="color:green">Q</span><span style="color:green">T</span><span style="color:green">S</span><span style="color:yellow">P</span><span style="color:turquoise">Y</span><span style="color:turquoise">Y</span><span style="color:magenta">E</span><span style="color:blue">I</span><span style="color:blue">V</span><span style="color:blue">F</span><span style="color:orange">G</span><span style="color:pink">H</span><span style="color:green">Q</span>
</td>
<td>0.29</td>
<td>0.22</td>
<td>0.14</td>
<td>0.25</td>
<td>0.14</td>
<td>0.20</td>
<td>0.17</td>
<td>0.21</td>
<td>-</td>
<td>0.28</td>
</tr>
<tr>
<td>AfOr_Motif10</td>
<td>11</td>
<td class="sequence">
<span style="color:green">S</span><span style="color:blue">F</span><span style="color:green">S</span><span style="color:turquoise">Y</span><span style="color:blue">F</span><span style="color:green">N</span><span style="color:blue">V</span><span style="color:blue">L</span><span style="color:red">R</span><span style="color:green">Q</span><span style="color:blue">M</span>
</td>
<td>0.35</td>
<td>0.43</td>
<td>0.17</td>
<td>0.25</td>
<td>0.26</td>
<td>0.33</td>
<td>0.19</td>
<td>0.31</td>
<td>0.28</td>
<td>-</td>
</tr>
</tbody>
</table>
</div>
</div>
<table id="results" width="100%" border="0" cellspacing="1" cellpadding="4" bgcolor="#FFFFFF"><tr>
<td><h2 class="mainh">Search Results</h2></td>
<td align="right" valign="bottom"><a href="#top">Top</a></td>
</tr></table>
<div class="box">
<h4>Top Scoring Sequences</h4>
<div class="pad">
<p>
          Each of the following 2 sequences has an <i>E</i>-value less than 
          10.<br>
          The motif matches shown have a position p-value less than 0.0001.<br><b>Click on the arrow</b> (↧) next to the <i>E</i>-value to view more information about a sequence.
        </p>
<div style="text-align:right">
<table style="display:inline-block; padding:5px;"><tr>
<td><div style="width: 20px; height: 20px; background-color:aqua; border: 1px solid black"></div></td>
<td>Motif AfOr_Motif1</td>
</tr></table>
<table style="display:inline-block; padding:5px;"><tr>
<td><div style="width: 20px; height: 20px; background-color:blue; border: 1px solid black"></div></td>
<td>Motif AfOr_Motif2</td>
</tr></table>
<table style="display:inline-block; padding:5px;"><tr>
<td><div style="width: 20px; height: 20px; background-color:red; border: 1px solid black"></div></td>
<td>Motif AfOr_Motif3</td>
</tr></table>
<table style="display:inline-block; padding:5px;"><tr>
<td><div style="width: 20px; height: 20px; background-color:fuchsia; border: 1px solid black"></div></td>
<td>Motif AfOr_Motif4</td>
</tr></table>
<table style="display:inline-block; padding:5px;"><tr>
<td><div style="width: 20px; height: 20px; background-color:yellow; border: 1px solid black"></div></td>
<td>Motif AfOr_Motif5</td>
</tr></table>
<table style="display:inline-block; padding:5px;"><tr>
<td><div style="width: 20px; height: 20px; background-color:lime; border: 1px solid black"></div></td>
<td>Motif AfOr_Motif6</td>
</tr></table>
<table style="display:inline-block; padding:5px;"><tr>
<td><div style="width: 20px; height: 20px; background-color:teal; border: 1px solid black"></div></td>
<td>Motif AfOr_Motif7</td>
</tr></table>
<table style="display:inline-block; padding:5px;"><tr>
<td><div style="width: 20px; height: 20px; background-color:#444444; border: 1px solid black"></div></td>
<td>Motif AfOr_Motif8</td>
</tr></table>
<table style="display:inline-block; padding:5px;"><tr>
<td><div style="width: 20px; height: 20px; background-color:green; border: 1px solid black"></div></td>
<td>Motif AfOr_Motif9</td>
</tr></table>
<table style="display:inline-block; padding:5px;"><tr>
<td><div style="width: 20px; height: 20px; background-color:silver; border: 1px solid black"></div></td>
<td>Motif AfOr_Motif10</td>
</tr></table>
</div>
<table id="tbl_sequences" style="width:100%; table-layout:fixed;" border="0">
<col style="width:49em;">
<col style="width:6em;">
<col style="width:3em;">
<col>
<thead>
<th>Sequence <div class="help" onclick="help_popup(this,'pop_sequence')"></div>
</th>
<th>
<i>E</i>-value <div class="help" onclick="help_popup(this,'pop_evalue')"></div>
</th>
<th> </th>
<th>Block Diagram <div class="help" onclick="help_popup(this,'pop_diagram')"></div>
</th>
</thead>
<tfoot><tr>
<td colspan="3"> </td>
<td class="block_td" style="color: blue;"><div class="block_container">
<div class="tic_major" style="left:0%"><div class="tic_label" style="left:-0.5em; width:1em;">0</div></div>
<div class="tic_minor" style="left:2.538%;"></div>
<div class="tic_minor" style="left:5.076%;"></div>
<div class="tic_minor" style="left:7.614%;"></div>
<div class="tic_minor" style="left:10.152%;"></div>
<div class="tic_major" style="left:12.69%"><div class="tic_label" style="left:-1em; width:2em;">50</div></div>
<div class="tic_minor" style="left:15.228%;"></div>
<div class="tic_minor" style="left:17.766%;"></div>
<div class="tic_minor" style="left:20.305%;"></div>
<div class="tic_minor" style="left:22.843%;"></div>
<div class="tic_major" style="left:25.381%"><div class="tic_label" style="left:-1.5em; width:3em;">100</div></div>
<div class="tic_minor" style="left:27.919%;"></div>
<div class="tic_minor" style="left:30.457%;"></div>
<div class="tic_minor" style="left:32.995%;"></div>
<div class="tic_minor" style="left:35.533%;"></div>
<div class="tic_major" style="left:38.071%"><div class="tic_label" style="left:-1.5em; width:3em;">150</div></div>
<div class="tic_minor" style="left:40.609%;"></div>
<div class="tic_minor" style="left:43.147%;"></div>
<div class="tic_minor" style="left:45.685%;"></div>
<div class="tic_minor" style="left:48.223%;"></div>
<div class="tic_major" style="left:50.761%"><div class="tic_label" style="left:-1.5em; width:3em;">200</div></div>
<div class="tic_minor" style="left:53.299%;"></div>
<div class="tic_minor" style="left:55.838%;"></div>
<div class="tic_minor" style="left:58.376%;"></div>
<div class="tic_minor" style="left:60.914%;"></div>
<div class="tic_major" style="left:63.452%"><div class="tic_label" style="left:-1.5em; width:3em;">250</div></div>
<div class="tic_minor" style="left:65.99%;"></div>
<div class="tic_minor" style="left:68.528%;"></div>
<div class="tic_minor" style="left:71.066%;"></div>
<div class="tic_minor" style="left:73.604%;"></div>
<div class="tic_major" style="left:76.142%"><div class="tic_label" style="left:-1.5em; width:3em;">300</div></div>
<div class="tic_minor" style="left:78.68%;"></div>
<div class="tic_minor" style="left:81.218%;"></div>
<div class="tic_minor" style="left:83.756%;"></div>
<div class="tic_minor" style="left:86.294%;"></div>
<div class="tic_major" style="left:88.832%"><div class="tic_label" style="left:-1.5em; width:3em;">350</div></div>
<div class="tic_minor" style="left:91.371%;"></div>
<div class="tic_minor" style="left:93.909%;"></div>
<div class="tic_minor" style="left:96.447%;"></div>
<div class="tic_minor" style="left:98.985%;"></div>
</div></td>
</tr></tfoot>
<tbody>
<tr id="seq_1_1_blocks" class="">
<td>LHQN01028732.1_1228-6288_OR_Complete_Normal_StartCodonPresent</td>
<td>6.2e-29</td>
<td><a href="javascript:show_more('seq_1_1')" class="more_arrow" title="Toggle additional information">↧</a></td>
<td class="block_td"><div class="block_container" id="seq_1_1_block_container">
<div class="block_rule" style="width:100%"></div>
<div class="block_motif" style="left:3.553%; top:4.2px; width:3.807%; height:6.8px; background-color:yellow; border: 1px solid black;" title="Motif AfOr_Motif5    p-value: 2.3e-06    starts: 15    ends: 29    "></div>
<div class="block_motif" style="left:23.35%; top:4.1px; width:5.33%; height:6.9px; background-color:teal; border: 1px solid black;" title="Motif AfOr_Motif7    p-value: 1.8e-06    starts: 93    ends: 113    "></div>
<div class="block_motif" style="left:52.284%; top:0.699999999999999px; width:5.33%; height:10.3px; background-color:blue; border: 1px solid black;" title="Motif AfOr_Motif2    p-value: 2.5e-09    starts: 207    ends: 227    "></div>
<div class="block_motif" style="left:62.437%; top:1.199999999999999px; width:5.33%; height:9.800000000000001px; background-color:lime; border: 1px solid black;" title="Motif AfOr_Motif6    p-value: 6.8e-09    starts: 247    ends: 267    "></div>
<div class="block_motif" style="left:79.442%; top:4px; width:5.33%; height:7px; background-color:fuchsia; border: 1px solid black;" title="Motif AfOr_Motif4    p-value: 1.5e-06    starts: 314    ends: 334    "></div>
<div class="block_motif" style="left:84.772%; top:0.9px; width:3.807%; height:10.1px; background-color:red; border: 1px solid black;" title="Motif AfOr_Motif3    p-value: 4.2e-09    starts: 335    ends: 349    "></div>
<div class="block_motif" style="left:91.878%; top:-1px; width:5.33%; height:12px; background-color:aqua; border: 1px solid black;" title="Motif AfOr_Motif1    p-value: 3.3e-13    starts: 363    ends: 383    "></div>
<div class="block_motif" style="left:97.208%; top:3.6px; width:2.792%; height:7.4px; background-color:silver; border: 1px solid black;" title="Motif AfOr_Motif10    p-value: 7.2e-07    starts: 384    ends: 394    "></div>
</div></td>
</tr>
<tr id="seq_1_2_blocks" class="">
<td>LHQN01028732.1_7630-8132_OR_Partial_Normal_StartCodonAbsent</td>
<td>1.1e-07</td>
<td><a href="javascript:show_more('seq_1_2')" class="more_arrow" title="Toggle additional information">↧</a></td>
<td class="block_td"><div class="block_container" id="seq_1_2_block_container">
<div class="block_rule" style="width:30.4568527918782%"></div>
<div class="block_motif" style="left:3.046%; top:5.6px; width:5.33%; height:5.4px; background-color:aqua; border: 1px solid black;" title="Motif AfOr_Motif1    p-value: 3.1e-05    starts: 13    ends: 33    "></div>
<div class="block_motif" style="left:13.452%; top:4.1px; width:5.33%; height:6.9px; background-color:fuchsia; border: 1px solid black;" title="Motif AfOr_Motif4    p-value: 1.7e-06    starts: 54    ends: 74    "></div>
<div class="block_motif" style="left:18.782%; top:0.699999999999999px; width:3.807%; height:10.3px; background-color:red; border: 1px solid black;" title="Motif AfOr_Motif3    p-value: 2.6e-09    starts: 75    ends: 89    "></div>
</div></td>
</tr>
</tbody>
</table>
<div style="text-align:right">
<table style="display:inline-block; padding:5px;"><tr>
<td><div style="width: 20px; height: 20px; background-color:aqua; border: 1px solid black"></div></td>
<td>Motif AfOr_Motif1</td>
</tr></table>
<table style="display:inline-block; padding:5px;"><tr>
<td><div style="width: 20px; height: 20px; background-color:blue; border: 1px solid black"></div></td>
<td>Motif AfOr_Motif2</td>
</tr></table>
<table style="display:inline-block; padding:5px;"><tr>
<td><div style="width: 20px; height: 20px; background-color:red; border: 1px solid black"></div></td>
<td>Motif AfOr_Motif3</td>
</tr></table>
<table style="display:inline-block; padding:5px;"><tr>
<td><div style="width: 20px; height: 20px; background-color:fuchsia; border: 1px solid black"></div></td>
<td>Motif AfOr_Motif4</td>
</tr></table>
<table style="display:inline-block; padding:5px;"><tr>
<td><div style="width: 20px; height: 20px; background-color:yellow; border: 1px solid black"></div></td>
<td>Motif AfOr_Motif5</td>
</tr></table>
<table style="display:inline-block; padding:5px;"><tr>
<td><div style="width: 20px; height: 20px; background-color:lime; border: 1px solid black"></div></td>
<td>Motif AfOr_Motif6</td>
</tr></table>
<table style="display:inline-block; padding:5px;"><tr>
<td><div style="width: 20px; height: 20px; background-color:teal; border: 1px solid black"></div></td>
<td>Motif AfOr_Motif7</td>
</tr></table>
<table style="display:inline-block; padding:5px;"><tr>
<td><div style="width: 20px; height: 20px; background-color:#444444; border: 1px solid black"></div></td>
<td>Motif AfOr_Motif8</td>
</tr></table>
<table style="display:inline-block; padding:5px;"><tr>
<td><div style="width: 20px; height: 20px; background-color:green; border: 1px solid black"></div></td>
<td>Motif AfOr_Motif9</td>
</tr></table>
<table style="display:inline-block; padding:5px;"><tr>
<td><div style="width: 20px; height: 20px; background-color:silver; border: 1px solid black"></div></td>
<td>Motif AfOr_Motif10</td>
</tr></table>
</div>
</div>
</div>
<div id="program" class="bar">
<div style="text-align:right;"><a href="#top">Top</a></div>
<div class="subsection">
<h5 id="version">MAST version</h5>4.10.2 (Release date: Thu Sep 03 15:00:54 2015 -0700)
      </div>
<div class="subsection">
<h5 id="reference">Reference</h5>
<span class="citation">
          Timothy L. Bailey and Michael Gribskov,
          "Combining evidence using p-values: application to sequence homology searches",
          <i>Bioinformatics</i>, <b>14</b>(1):48-54, 1998.
        </span>
</div>
<div class="subsection">
<h5 id="command">Command line summary</h5>
<textarea rows="5" style="width:100%;" readonly>mast /media/snehal/Data1/my_tools/insectOR//tools/motifs/AfOr_motifs exonerate.txt.ORs.starRemoved.pep -oc . -nostatus</textarea><br>Background letter frequencies (from non-redundant database):<br><div style="margin-left:25px;">A: 0.073   C: 0.018   D: 0.052   E: 0.062   F: 0.040   G: 0.069   H: 0.022   I: 0.056   K: 0.058   L: 0.092   M: 0.023   N: 0.046   P: 0.051   Q: 0.041   R: 0.052   S: 0.074   T: 0.059   V: 0.064   W: 0.013   Y: 0.033</div>
<br>Result calculation took 0.059 seconds<br>
</div>
<a href="javascript:showHidden('model')" id="model_activator">show model parameters...</a><div class="subsection" id="model_data" style="display:none;">
<h5>Model parameters</h5>
<textarea style="width:100%;" rows="10" readonly>
max_correlation       = 0.60
remove_correlated     = value: "n"
strand_handling       = value: "protein"
translate_dna         = value: "n"
max_seq_evalue        = 10
adj_hit_pvalue        = value: "n"
max_hit_pvalue        = 0.0001
max_weak_pvalue       = 0.0001
host                  = snehal-HP-ZBook-Studio-G5
when                  = Mon Oct 5 14:48:51 2020
</textarea>
</div>
<a href="javascript:hideShown('model')" style="display:none;" id="model_deactivator">hide model parameters...</a>
</div>
<span class="explain"><table id="doc" width="100%" border="0" cellspacing="1" cellpadding="4" bgcolor="#FFFFFF"><tr>
<td><h2 class="mainh">Explanation of MAST Results</h2></td>
<td align="right" valign="bottom"><a href="#top">Top</a></td>
</tr></table>
<div class="box">
<h4>The MAST results consist of</h4>
<ul>
<li>The <a href="#input_motifs_doc"><b>inputs</b></a> to MAST including:
            <ol>
<li>The <a href="#databases_doc"><b>sequence databases</b></a> showing the sequence 
                and residue counts. [<a href="#databases">View</a>]</li>
<li>The <a href="#motifs_doc"><b>motifs</b></a> showing the name, width, best scoring match 
                and similarity to other motifs. [<a href="#motifs">View</a>]</li>
<li>
                The <a href="#nos_doc"><b>nominal order and spacing</b></a> diagram.</li>
</ol>
</li>
<li>The <a href="#sequences_doc"><b>search results</b></a> showing top scoring sequences with 
            tiling of all of the motifs matches shown for each of the sequences. [<a href="#results">View</a>]
          </li>
<li>The <b>program</b> details including:
            <ol>
<li>The <b>version</b> of MAST and the date it was released. [<a href="#version">View</a>]</li>
<li>The <b>reference</b> to cite if you use MAST in your research. [<a href="#reference">View</a>]</li>
<li>The <b>command line summary</b> detailing the parameters with which you ran MAST. [<a href="#command">View</a>]</li>
</ol>
</li>
<li>This <b>explanation</b> of how to interpret MAST results.</li>
</ul>
<h4 id="input_motifs_doc">Inputs</h4>
<p>MAST received the following inputs.</p>
<h5 id="databases_doc">Sequence Databases</h5>
<div class="doc">
<p>This table summarises the sequence databases specified to MAST.</p>
<dl>
<dt>Database</dt>
<dd>The name of the database file.</dd>
<dt>Sequence Count</dt>
<dd>The number of sequences in the database.</dd>
<dt>Residue Count</dt>
<dd>The number of residues in the database.</dd>
</dl>
</div>
<h5 id="motifs_doc">Motifs</h5>
<div class="doc">
<p>Summary of the motifs specified to MAST.</p>
<dl>
<dt>Name</dt>
<dd>The name of the motif. If the motif has been removed or removal is recommended to avoid highly similar motifs 
              then it will be displayed in red text.</dd>
<dt>Width</dt>
<dd>The width of the motif. No gaps are allowed in motifs supplied to MAST as it only works for motifs of a fixed width.</dd>
<dt>Best possible match</dt>
<dd>The sequence that would achieve the best possible match score and its reverse complement for nucleotide motifs.</dd>
<dt>Similarity</dt>
<dd>
              MAST computes the pairwise correlations between each pair of motifs. The correlation between two motifs is the 
              maximum sum of Pearson's correlation coefficients for aligned columns divided by the width of the shorter motif. 
              The maximum is found by trying all alignments of the two motifs. Motifs with correlations below 0.60 have little 
              effect on the accuracy of the combined scores. Pairs of motifs with higher correlations should be removed from 
              the query. Correlations above the supplied threshold are shown in red text.
            </dd>
</dl>
</div>
<h5 id="nos_doc">Nominal Order and Spacing</h5>
<div class="doc"><p>This diagram shows the normal spacing of the motifs specified to MAST.</p></div>
<h4 id="sequences_doc">Search Results</h4>
<p>MAST provides the following motif search results.</p>
<h5>Top Scoring Sequences</h5>
<div class="doc">
<p>
            This table summarises the top scoring sequences with a <a href="#evalue_doc">Sequence <i>E</i>-value</a>
            better than the threshold (default 10). The sequences are sorted by the <a href="#evalue_doc">Sequence 
            <i>E</i>-value</a> from most to least significant.
          </p>
<dl>
<dt>Sequence</dt>
<dd>The name of the sequence. This maybe be linked to search a sequence database for the sequence name.</dd>
<dt>
<i>E</i>-value</dt>
<dd>
              The <a href="#evalue_doc"><i>E</i>-value</a> of the sequence. For DNA only; if strands were scored seperately 
              then there will be two <i>E</i>-values for the sequence seperated by a "/". The score for the provided sequence 
              will be first and the score for the reverse-complement will be second.
            </dd>
<dt>↧</dt>
<dd>
              Click on this to show <a href="#additional_seq_doc">additional information</a> about the sequence such as a 
              description, combined p-value and the annotated sequence.
            </dd>
<dt>Block Diagram</dt>
<dd>
              The block diagram shows the best non-overlapping tiling of motif matches on the sequence.
              <ul style="padding-left: 1em; margin-top:5px;">
<li>The length of the line shows the length of a sequence relative to all the other sequences.</li>
<li>A block is shown where the <a href="#pos_pvalue_doc">positional <i>p</i>-value</a>
                  of a motif is less (more significant) than the significance threshold which is 0.0001 by default.</li>
<li>If a significant motif match (as specified above) overlaps other significant motif matches then 
                  it is only displayed as a block if its <a href="#pos_pvalue_doc">positional <i>p</i>-value</a> 
                  is less (more significant) then the product of the <a href="#pos_pvalue_doc">positional 
                  <i>p</i>-values</a> of the significant matches that it overlaps.</li>
<li>The position of a block shows where a motif has matched the sequence.</li>
<li>The width of a block shows the width of the motif relative to the length of the sequence.</li>
<li>The colour and border of a block identifies the matching motif as in the legend.</li>
<li>The height of a block gives an indication of the significance of the match as 
                  taller blocks are more significant. The height is calculated to be proportional 
                  to the negative logarithm of the <a href="#pos_pvalue_doc">positional <i>p</i>-value</a>, 
                  truncated at the height for a <i>p</i>-value of 1e-10.</li>
<li>Hovering the mouse cursor over the block causes the display of the motif name 
                    and other details in the hovering text.</li>
<li>DNA only; blocks displayed above the line are a match on the given DNA, whereas blocks 
                  displayed below the line are matches to the reverse-complement of the given DNA.</li>
<li>DNA only; when strands are scored separately then blocks may overlap on opposing strands.</li>
</ul>
</dd>
</dl>
</div>
<h5 id="additional_seq_doc">Additional Sequence Information</h5>
<div class="doc">
<p>
            Clicking on the ↧ link expands a box below the sequence with additional information and adds two dragable buttons 
            below the block diagram.
          </p>
<dl>
<dt>Description</dt>
<dd>The description appearing after the identifier in the fasta file used to specify the sequence.</dd>
<dt>Combined <i>p</i>-value</dt>
<dd>The <a href="#combined_pvalue_doc">combined <i>p</i>-value</a> of the sequence. DNA only; if strands were scored 
              seperately then there will be two <i>p</i>-values for the sequence seperated by a "/". The score for the provided sequence 
              will be first and the score for the reverse-complement will be second.</dd>
<dt id="anno_doc">Annotated Sequence</dt>
<dd>
              The annotated sequence shows a portion of the sequence with the matching motif sequences displayed above. 
              The displayed portion of the sequence can be modified by sliding the two buttons below the sequence block diagram
              so that the portion you want to see is between the two needles attached to the buttons. By default the two buttons
              move together but you can drag one individually by holding shift before you start the drag. If the strands were
              scored seperately then they can't be both displayed at once due to overlaps and so a radio button offers the choice
              of strand to display.
            </dd>
</dl>
</div>
<h4>Scoring</h4>
<p>MAST scores sequences using the following measures.</p>
<h5 id="score_doc">Position score calculation</h5>
<div class="doc"><p>
            The score for the match of a position in a sequence to a motif is computed by by summing the appropriate entry 
            from each column of the position-dependent scoring matrix that represents the motif. Sequences shorter than 
            one or more of the motifs are skipped.
          </p></div>
<h5 id="pos_pvalue_doc">Position <i>p</i>-value</h5>
<div class="doc"><p>
            The position p-value of a match is the probability of a single random subsequence of the length of the motif 
            scoring at least as well as the observed match.
          </p></div>
<h5 id="seq_pvalue_doc">Sequence <i>p</i>-value</h5>
<div class="doc"><p>
            The sequence p-value of a score is defined as the probability of a random sequence of the same length containing 
            some match with as good or better a score.
          </p></div>
<h5 id="combined_pvalue_doc">Combined <i>p</i>-value</h5>
<div class="doc">
<p>The combined p-value of a sequence measures the strength of the match of the sequence to all the motifs and is calculated by</p>
<ol>
<li>finding the score of the single best match of each motif to the sequence (best matches may overlap),</li>
<li>calculating the sequence p-value of each score,</li>
<li>forming the product of the p-values,</li>
<li>taking the p-value of the product.</li>
</ol>
</div>
<h5 id="evalue_doc">Sequence <i>E</i>-value</h5>
<div class="doc"><p>
            The E-value of a sequence is the expected number of sequences in a random database of the same size that would match 
            the motifs as well as the sequence does and is equal to the combined p-value of the sequence times the number of 
            sequences in the database.
          </p></div>
</div></span>
<!--This data is used by the javascript to create the detailed views-->
<form>
<input type="hidden" id="seq_1_1_len" value="394">
<input type="hidden" id="seq_1_1_desc" value="">
<input type="hidden" id="seq_1_1_combined_pvalue" value="3.09e-29">
<input type="hidden" id="seq_1_1_type" value="amino-acid">
<input type="hidden" id="seq_1_1_segs" value="
1	MDAITLEKRYLRINKKLGMLTGVWPYQKSSPKWISRTVVLFVIIPCYVTQYARIVTFPRIHIILNDYPYLITSLG
76	VIIKFGNYFINESELKYLLGKIYEDWRAMTSEDEYKIMTKYAEKERSLSFCFTFEKVHISLCAALFMCLPFVSPI
151	LDILMPLNETRARLFVYPAYYFVDEDKYRYLIVGHMYLVVVMLISVFCACDANYVYAVQHACGLLAIAGYRFKYACYEVIPEDEKEAVKMMKKMYRNVCHSIRIHQRALQYVKEITAAHDTCMFISVGLLMMSISTSLLQISEHEHDAEW
301	TLYCTFFTAQLLHMLFLVVQGQFVLDAYDDVYNTIYESQWYNFTPRTQALYVLALRSCLNPPLLTAGGMTTLNLRSFAEIIKASVSYYTVMQTK
">
<input type="hidden" id="seq_1_1_hits" value="
15	motif_5	+	2.3e-06	+ ++ + ++++++ +	
93	motif_7	+	1.8e-06	    + +++++ + +++ +++	
207	motif_2	+	2.5e-09	 ++++++++++++++++ ++ 	
247	motif_6	+	6.8e-09	   + ++ +++++++++ + +	
314	motif_4	+	1.5e-06	++ +   ++ + +  +++ ++	
335	motif_3	+	4.2e-09	++++ +++ +++++ 	
363	motif_1	+	3.3e-13	 ++++++ ++++ ++++++++	
384	motif_10	+	7.2e-07	++++ +++++ 	
">
<input type="hidden" id="seq_1_2_len" value="120">
<input type="hidden" id="seq_1_2_desc" value="">
<input type="hidden" id="seq_1_2_combined_pvalue" value="5.48e-08">
<input type="hidden" id="seq_1_2_type" value="amino-acid">
<input type="hidden" id="seq_1_2_segs" value="
1	YITEIEQVHGTYLFIAVGMVMMSFSITLVRVSTMNPCVEFYKYCGFLVVQLVHLLFLSIQGHFVIVSHDTTYDNIYSATWYNGTPKVQALYVLALRRNLTPPLITAGGLISLNLETFAEV
">
<input type="hidden" id="seq_1_2_hits" value="
13	motif_1	+	3.1e-05	   + +++ ++ +     +++	
54	motif_4	+	1.7e-06	++ ++  +  ++ + +   + 	
75	motif_3	+	2.6e-09	++++++++ +++++ 	
">
</form>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><span class="sequence" id="ruler" style="visibility:hidden; white-space:nowrap;">ACGTN</span>
</body>
</html>
